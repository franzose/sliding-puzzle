{"version":3,"sources":["app.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","root","factory","define","amd","document","w","SVG","window","this","is","el","obj","matches","selector","matchesSelector","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","camelCase","toLowerCase","replace","m","g","toUpperCase","capitalize","charAt","slice","fullHex","hex","substring","join","compToHex","comp","toString","proportionalSize","element","width","height","box","bbox","deltaTransformPoint","matrix","x","y","c","b","d","arrayToMatrix","parseMatrix","Matrix","ensureCentre","target","cx","cy","stringToMatrix","source","regex","whitespace","split","matrixElements","utils","map","parseFloat","arrayToString","il","assignNewId","node","childNodes","SVGElement","adopt","id","eid","nodeName","fullBox","h","x2","y2","idFromReference","url","match","reference","supported","Doc","parser","draw","prepare","ns","xmlns","xlink","svgjs","createElementNS","createSVGRect","did","name","create","setAttribute","extend","modules","methods","key","arguments","pop","prototype","Set","inherit","invent","config","initializer","constructor","construct","parent","Container","instance","parentNode","Nested","Gradient","Element","type","namespace","defs","setData","JSON","parse","getAttribute","body","getElementsByTagName","documentElement","nested","size","style","poly","polyline","path","native","addEventListener","numberAndUnit","rgb","isHex","isRgb","isCss","isBlank","isNumber","isPercent","isImage","negExp","comma","hyphen","pathLetters","isPathLetter","whitespaces","X","array","block","result","push","filter","radians","Math","PI","degrees","filterSVGElements","nodes","defaults","attrs","fill-opacity","stroke-opacity","stroke-width","stroke-linejoin","stroke-linecap","fill","stroke","opacity","rx","ry","offset","stop-opacity","stop-color","font-size","font-family","text-anchor","Color","color","test","exec","parseInt","toHex","toRgb","brightness","morph","destination","at","pos","isColor","Array","fallback","valueOf","value","lastValue","lastDestination","settle","seen","indexOf","isArray","string","trim","reverse","PointArray","toLine","x1","y1","points","len","move","isNaN","getBBox","PathArray","x0","y0","seg","arr","paramCnt","M","L","H","V","C","S","Q","T","A","lastIndexOf","first","shift","splice","apply","concat","reduce","prev","curr","Number","unit","isFinite","toJSON","plus","number","minus","times","divide","to","_stroke","dom","attr","center","p","clone","cloneNode","add","after","remove","removeElement","addTo","put","putIn","inside","show","hide","visible","classes","hasClass","addClass","removeClass","toggleClass","get","doc","parents","svg","well","createElement","Parent","appendChild","writeDataToDom","innerHTML","firstChild","each","lines","fn","removeAttribute","Object","keys","stringify","easing","-","<>","cos",">","sin","<","from","MorphObj","Situation","init","reversed","reversing","duration","delay","start","Date","finish","ease","loop","loops","animations","styles","transforms","once","Delay","FX","_target","situations","active","situation","paused","lastPos","animate","queue","timeToPos","timestamp","posToTime","startAnimFrame","stopAnimFrame","animationFrame","requestAnimationFrame","step","bind","cancelAnimationFrame","initAnimations","dequeue","stop","setTimeout","viewbox","relative","initialTransformation","matrixify","clearQueue","clearCurrent","jumpToEnd","clearTimeout","timeout","reset","temp","speed","last","pause","play","progress","easeIt","wrapper","detail","off","on","during","eased","afterAll","duringAll","method","args","ignoreTime","fire","fx","eachAt","self","multiply","undo","extract","isEased","real","v","G","transform","num","Text","plot","leading","ViewBox","update","Stop","BBox","contains","Exception","Shape","clientLeft","clientTop","clientWidth","clientHeight","TBox","ctm","scaleX","scaleY","tbox","RBox","getBoundingClientRect","zoom","left","top","offsetLeft","offsetTop","offsetParent","pageXOffset","pageYOffset","rbox","forEach","merge","min","max","base","abcdef","px","py","skewX","atan2","transformedX","sqrt","transformedY","skewY","rotation","param","rotate","inverse","translate","scale","around","flip","skew","createSVGMatrix","getCTM","screenCTM","getScreenCTM","Point","point","createSVGPoint","matrixTransform","attributes","nodeValue","image","Image","pattern","setAttributeNS","rebuild","Rotate","Scale","Skew","Translate","untransform","str","kv","toParent","rect","pCtm","toDoc","Transformation","inversed","params","_undo","cssText","children","insertBefore","has","index","deep","removeChild","clear","hasChildNodes","lastChild","_defs","ungroup","depth","Defs","Infinity","flatten","view","we","he","wm","hm","reg","offsetWidth","offsetHeight","event","listeners","handlerMap","listenerId","listener","binding","ev","_svgjsListenerId","removeEventListener","data","Event","dispatchEvent","CustomEvent","gbox","trans","group","siblings","position","next","previous","forward","backward","front","back","before","Mask","targets","unmask","mask","maskWith","masker","ClipPath","unclip","clip","clipWith","clipper","gradient","fy","Pattern","patternUnits","getElementById","version","spof","Bare","words","text","createTextNode","symbol","Use","file","use","Rect","Circle","circle","Ellipse","ellipse","Line","line","Polyline","Polygon","polygon","_array","morphArray","Path","load","img","onload","_loaded","ratio","onerror","_error","src","loaded","error","_rebuild","_build","textPath","newLined","oy","nodeType","textContent","build","tspan","newLine","blankLineOffset","dy","plain","Tspan","dx","getComputedTextLength","TextPath","track","link","linkTo","Marker","ref","marker","sugar","prefix","extension","dmove","radius","getTotalLength","pointAt","getPointAtLength","font","k","members","elements","set","remember","memory","forget","_memory","select","query","querySelectorAll","options","bubbles","cancelable","undefined","createEvent","initCustomEvent","lastTime","vendors","callback","currTime","getTime","timeToCall","2","_interopRequireDefault","__esModule","default","_constants","_constants2","_templates","_templates2","_functions","_game","_game2","container","launch","timeContainer","time","results","winnerTemplate","winner","strings","WINNER","MOVES","TIME","game","onLaunch","classList","HIDDEN","onEach","seconds","formatTime","onStop","moves","won","drawEmpty","./constants","./functions","./game","./polyfills","./templates","3","defineProperty","VISIBLE","SELECTED","dimensions","SQUARE_SIZE","SQUARE_MARGIN","direction","UNDEF","LEFT","RIGHT","UP","DOWN","animation","MOVE_DURATION","4","inArray","values","range","count","getRandomInt","floor","random","getRandomGameNumbers","sort","_","getDirectionFromKeyCode","hours","minutes","5","countMove","playerHasWon","that","squares","getPositions","every","combinationToWin","_this","_svg2","started","_squares2","timer","_timer2","_images2","rectangle","square","getSquareByNode","isMovable","isEmpty","deselect","closest","keyCode","moveByDirection","_svg","_images","_squares","_timer","./images","./squares","./timer","svg.js","6","empty","7","find","predicate","TypeError","list","thisArg","8","getSquaresGroup","selected","getEmptySvgSquare","emptySquare","getMoveCoordsFromDirection","coords","getSquareByCoords","reindexSquares","targetIndex","emptyIndex","squareClass","leftIndex","topIndex","numbers","idx","emptyBox","leftRight","topBottom","squareBox","9","10"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*!\n* svg.js - A lightweight library for manipulating and animating SVG.\n* @version 2.3.5\n* http://www.svgjs.com\n*\n* @copyright Wout Fierens <wout@woutfierens.com>\n* @license MIT\n*\n* BUILT: Thu Oct 13 2016 17:32:45 GMT+0200 (Mitteleuropische Sommerzeit)\n*/;\n(function(root, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function(){\r\n      return factory(root, root.document)\r\n    })\r\n  } else if (typeof exports === 'object') {\r\n    module.exports = root.document ? factory(root, root.document) : function(w){ return factory(w, w.document) }\r\n  } else {\r\n    root.SVG = factory(root, root.document)\r\n  }\r\n}(typeof window !== \"undefined\" ? window : this, function(window, document) {\r\n\r\n// The main wrapping element\r\nvar SVG = this.SVG = function(element) {\r\n  if (SVG.supported) {\r\n    element = new SVG.Doc(element)\r\n\r\n    if(!SVG.parser.draw)\r\n      SVG.prepare()\r\n\r\n    return element\r\n  }\r\n}\r\n\r\n// Default namespaces\r\nSVG.ns    = 'http://www.w3.org/2000/svg'\r\nSVG.xmlns = 'http://www.w3.org/2000/xmlns/'\r\nSVG.xlink = 'http://www.w3.org/1999/xlink'\r\nSVG.svgjs = 'http://svgjs.com/svgjs'\r\n\r\n// Svg support test\r\nSVG.supported = (function() {\r\n  return !! document.createElementNS &&\r\n         !! document.createElementNS(SVG.ns,'svg').createSVGRect\r\n})()\r\n\r\n// Don't bother to continue if SVG is not supported\r\nif (!SVG.supported) return false\r\n\r\n// Element id sequence\r\nSVG.did  = 1000\r\n\r\n// Get next named element id\r\nSVG.eid = function(name) {\r\n  return 'Svgjs' + capitalize(name) + (SVG.did++)\r\n}\r\n\r\n// Method for element creation\r\nSVG.create = function(name) {\r\n  // create element\r\n  var element = document.createElementNS(this.ns, name)\r\n\r\n  // apply unique id\r\n  element.setAttribute('id', this.eid(name))\r\n\r\n  return element\r\n}\r\n\r\n// Method for extending objects\r\nSVG.extend = function() {\r\n  var modules, methods, key, i\r\n\r\n  // Get list of modules\r\n  modules = [].slice.call(arguments)\r\n\r\n  // Get object with extensions\r\n  methods = modules.pop()\r\n\r\n  for (i = modules.length - 1; i >= 0; i--)\r\n    if (modules[i])\r\n      for (key in methods)\r\n        modules[i].prototype[key] = methods[key]\r\n\r\n  // Make sure SVG.Set inherits any newly added methods\r\n  if (SVG.Set && SVG.Set.inherit)\r\n    SVG.Set.inherit()\r\n}\r\n\r\n// Invent new element\r\nSVG.invent = function(config) {\r\n  // Create element initializer\r\n  var initializer = typeof config.create == 'function' ?\r\n    config.create :\r\n    function() {\r\n      this.constructor.call(this, SVG.create(config.create))\r\n    }\r\n\r\n  // Inherit prototype\r\n  if (config.inherit)\r\n    initializer.prototype = new config.inherit\r\n\r\n  // Extend with methods\r\n  if (config.extend)\r\n    SVG.extend(initializer, config.extend)\r\n\r\n  // Attach construct method to parent\r\n  if (config.construct)\r\n    SVG.extend(config.parent || SVG.Container, config.construct)\r\n\r\n  return initializer\r\n}\r\n\r\n// Adopt existing svg elements\r\nSVG.adopt = function(node) {\r\n  // check for presence of node\r\n  if (!node) return null\r\n\r\n  // make sure a node isn't already adopted\r\n  if (node.instance) return node.instance\r\n\r\n  // initialize variables\r\n  var element\r\n\r\n  // adopt with element-specific settings\r\n  if (node.nodeName == 'svg')\r\n    element = node.parentNode instanceof SVGElement ? new SVG.Nested : new SVG.Doc\r\n  else if (node.nodeName == 'linearGradient')\r\n    element = new SVG.Gradient('linear')\r\n  else if (node.nodeName == 'radialGradient')\r\n    element = new SVG.Gradient('radial')\r\n  else if (SVG[capitalize(node.nodeName)])\r\n    element = new SVG[capitalize(node.nodeName)]\r\n  else\r\n    element = new SVG.Element(node)\r\n\r\n  // ensure references\r\n  element.type  = node.nodeName\r\n  element.node  = node\r\n  node.instance = element\r\n\r\n  // SVG.Class specific preparations\r\n  if (element instanceof SVG.Doc)\r\n    element.namespace().defs()\r\n\r\n  // pull svgjs data from the dom (getAttributeNS doesn't work in html5)\r\n  element.setData(JSON.parse(node.getAttribute('svgjs:data')) || {})\r\n\r\n  return element\r\n}\r\n\r\n// Initialize parsing element\r\nSVG.prepare = function() {\r\n  // Select document body and create invisible svg element\r\n  var body = document.getElementsByTagName('body')[0]\r\n    , draw = (body ? new SVG.Doc(body) :  new SVG.Doc(document.documentElement).nested()).size(2, 0)\r\n\r\n  // Create parser object\r\n  SVG.parser = {\r\n    body: body || document.documentElement\r\n  , draw: draw.style('opacity:0;position:fixed;left:100%;top:100%;overflow:hidden')\r\n  , poly: draw.polyline().node\r\n  , path: draw.path().node\r\n  , native: SVG.create('svg')\r\n  }\r\n}\r\n\r\nSVG.parser = {\r\n  native: SVG.create('svg')\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  if(!SVG.parser.draw)\r\n    SVG.prepare()\r\n}, false)\r\n\n// Storage for regular expressions\r\nSVG.regex = {\r\n  // Parse unit value\r\n  numberAndUnit:    /^([+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?)([a-z%]*)$/i\r\n\r\n  // Parse hex value\r\n, hex:              /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i\r\n\r\n  // Parse rgb value\r\n, rgb:              /rgb\\((\\d+),(\\d+),(\\d+)\\)/\r\n\r\n  // Parse reference id\r\n, reference:        /#([a-z0-9\\-_]+)/i\r\n\r\n  // Parse matrix wrapper\r\n, matrix:           /matrix\\(|\\)/g\r\n\r\n  // Elements of a matrix\r\n, matrixElements:   /,*\\s+|,/\r\n\r\n  // Whitespace\r\n, whitespace:       /\\s/g\r\n\r\n  // Test hex value\r\n, isHex:            /^#[a-f0-9]{3,6}$/i\r\n\r\n  // Test rgb value\r\n, isRgb:            /^rgb\\(/\r\n\r\n  // Test css declaration\r\n, isCss:            /[^:]+:[^;]+;?/\r\n\r\n  // Test for blank string\r\n, isBlank:          /^(\\s+)?$/\r\n\r\n  // Test for numeric string\r\n, isNumber:         /^[+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i\r\n\r\n  // Test for percent value\r\n, isPercent:        /^-?[\\d\\.]+%$/\r\n\r\n  // Test for image url\r\n, isImage:          /\\.(jpg|jpeg|png|gif|svg)(\\?[^=]+.*)?/i\r\n\r\n  // The following regex are used to parse the d attribute of a path\r\n\r\n  // Replaces all negative exponents\r\n, negExp:           /e\\-/gi\r\n\r\n  // Replaces all comma\r\n, comma:            /,/g\r\n\r\n  // Replaces all hyphens\r\n, hyphen:           /\\-/g\r\n\r\n  // Replaces and tests for all path letters\r\n, pathLetters:      /[MLHVCSQTAZ]/gi\r\n\r\n  // yes we need this one, too\r\n, isPathLetter:     /[MLHVCSQTAZ]/i\r\n\r\n  // split at whitespaces\r\n, whitespaces:      /\\s+/\r\n\r\n  // matches X\r\n, X:                /X/g\r\n}\r\n\nSVG.utils = {\r\n  // Map function\r\n  map: function(array, block) {\r\n    var i\r\n      , il = array.length\r\n      , result = []\r\n\r\n    for (i = 0; i < il; i++)\r\n      result.push(block(array[i]))\r\n\r\n    return result\r\n  }\r\n\r\n  // Filter function\r\n, filter: function(array, block) {\r\n    var i\r\n      , il = array.length\r\n      , result = []\r\n\r\n    for (i = 0; i < il; i++)\r\n      if (block(array[i]))\r\n        result.push(array[i])\r\n\r\n    return result\r\n  }\r\n\r\n  // Degrees to radians\r\n, radians: function(d) {\r\n    return d % 360 * Math.PI / 180\r\n  }\r\n\r\n  // Radians to degrees\r\n, degrees: function(r) {\r\n    return r * 180 / Math.PI % 360\r\n  }\r\n\r\n, filterSVGElements: function(nodes) {\r\n    return this.filter( nodes, function(el) { return el instanceof SVGElement })\r\n  }\r\n\r\n}\n\r\nSVG.defaults = {\r\n  // Default attribute values\r\n  attrs: {\r\n    // fill and stroke\r\n    'fill-opacity':     1\r\n  , 'stroke-opacity':   1\r\n  , 'stroke-width':     0\r\n  , 'stroke-linejoin':  'miter'\r\n  , 'stroke-linecap':   'butt'\r\n  , fill:               '#000000'\r\n  , stroke:             '#000000'\r\n  , opacity:            1\r\n    // position\r\n  , x:                  0\r\n  , y:                  0\r\n  , cx:                 0\r\n  , cy:                 0\r\n    // size\r\n  , width:              0\r\n  , height:             0\r\n    // radius\r\n  , r:                  0\r\n  , rx:                 0\r\n  , ry:                 0\r\n    // gradient\r\n  , offset:             0\r\n  , 'stop-opacity':     1\r\n  , 'stop-color':       '#000000'\r\n    // text\r\n  , 'font-size':        16\r\n  , 'font-family':      'Helvetica, Arial, sans-serif'\r\n  , 'text-anchor':      'start'\r\n  }\r\n\r\n}\n// Module for color convertions\r\nSVG.Color = function(color) {\r\n  var match\r\n\r\n  // initialize defaults\r\n  this.r = 0\r\n  this.g = 0\r\n  this.b = 0\r\n\r\n  if(!color) return\r\n\r\n  // parse color\r\n  if (typeof color === 'string') {\r\n    if (SVG.regex.isRgb.test(color)) {\r\n      // get rgb values\r\n      match = SVG.regex.rgb.exec(color.replace(/\\s/g,''))\r\n\r\n      // parse numeric values\r\n      this.r = parseInt(match[1])\r\n      this.g = parseInt(match[2])\r\n      this.b = parseInt(match[3])\r\n\r\n    } else if (SVG.regex.isHex.test(color)) {\r\n      // get hex values\r\n      match = SVG.regex.hex.exec(fullHex(color))\r\n\r\n      // parse numeric values\r\n      this.r = parseInt(match[1], 16)\r\n      this.g = parseInt(match[2], 16)\r\n      this.b = parseInt(match[3], 16)\r\n\r\n    }\r\n\r\n  } else if (typeof color === 'object') {\r\n    this.r = color.r\r\n    this.g = color.g\r\n    this.b = color.b\r\n\r\n  }\r\n\r\n}\r\n\r\nSVG.extend(SVG.Color, {\r\n  // Default to hex conversion\r\n  toString: function() {\r\n    return this.toHex()\r\n  }\r\n  // Build hex value\r\n, toHex: function() {\r\n    return '#'\r\n      + compToHex(this.r)\r\n      + compToHex(this.g)\r\n      + compToHex(this.b)\r\n  }\r\n  // Build rgb value\r\n, toRgb: function() {\r\n    return 'rgb(' + [this.r, this.g, this.b].join() + ')'\r\n  }\r\n  // Calculate true brightness\r\n, brightness: function() {\r\n    return (this.r / 255 * 0.30)\r\n         + (this.g / 255 * 0.59)\r\n         + (this.b / 255 * 0.11)\r\n  }\r\n  // Make color morphable\r\n, morph: function(color) {\r\n    this.destination = new SVG.Color(color)\r\n\r\n    return this\r\n  }\r\n  // Get morphed color at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // normalise pos\r\n    pos = pos < 0 ? 0 : pos > 1 ? 1 : pos\r\n\r\n    // generate morphed color\r\n    return new SVG.Color({\r\n      r: ~~(this.r + (this.destination.r - this.r) * pos)\r\n    , g: ~~(this.g + (this.destination.g - this.g) * pos)\r\n    , b: ~~(this.b + (this.destination.b - this.b) * pos)\r\n    })\r\n  }\r\n\r\n})\r\n\r\n// Testers\r\n\r\n// Test if given value is a color string\r\nSVG.Color.test = function(color) {\r\n  color += ''\r\n  return SVG.regex.isHex.test(color)\r\n      || SVG.regex.isRgb.test(color)\r\n}\r\n\r\n// Test if given value is a rgb object\r\nSVG.Color.isRgb = function(color) {\r\n  return color && typeof color.r == 'number'\r\n               && typeof color.g == 'number'\r\n               && typeof color.b == 'number'\r\n}\r\n\r\n// Test if given value is a color\r\nSVG.Color.isColor = function(color) {\r\n  return SVG.Color.isRgb(color) || SVG.Color.test(color)\r\n}\n// Module for array conversion\r\nSVG.Array = function(array, fallback) {\r\n  array = (array || []).valueOf()\r\n\r\n  // if array is empty and fallback is provided, use fallback\r\n  if (array.length == 0 && fallback)\r\n    array = fallback.valueOf()\r\n\r\n  // parse array\r\n  this.value = this.parse(array)\r\n}\r\n\r\nSVG.extend(SVG.Array, {\r\n  // Make array morphable\r\n  morph: function(array) {\r\n    this.destination = this.parse(array)\r\n\r\n    // normalize length of arrays\r\n    if (this.value.length != this.destination.length) {\r\n      var lastValue       = this.value[this.value.length - 1]\r\n        , lastDestination = this.destination[this.destination.length - 1]\r\n\r\n      while(this.value.length > this.destination.length)\r\n        this.destination.push(lastDestination)\r\n      while(this.value.length < this.destination.length)\r\n        this.value.push(lastValue)\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Clean up any duplicate points\r\n, settle: function() {\r\n    // find all unique values\r\n    for (var i = 0, il = this.value.length, seen = []; i < il; i++)\r\n      if (seen.indexOf(this.value[i]) == -1)\r\n        seen.push(this.value[i])\r\n\r\n    // set new value\r\n    return this.value = seen\r\n  }\r\n  // Get morphed array at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // generate morphed array\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push(this.value[i] + (this.destination[i] - this.value[i]) * pos)\r\n\r\n    return new SVG.Array(array)\r\n  }\r\n  // Convert array to string\r\n, toString: function() {\r\n    return this.value.join(' ')\r\n  }\r\n  // Real value\r\n, valueOf: function() {\r\n    return this.value\r\n  }\r\n  // Parse whitespace separated string\r\n, parse: function(array) {\r\n    array = array.valueOf()\r\n\r\n    // if already is an array, no need to parse it\r\n    if (Array.isArray(array)) return array\r\n\r\n    return this.split(array)\r\n  }\r\n  // Strip unnecessary whitespace\r\n, split: function(string) {\r\n    return string.trim().split(/\\s+/)\r\n  }\r\n  // Reverse array\r\n, reverse: function() {\r\n    this.value.reverse()\r\n\r\n    return this\r\n  }\r\n\r\n})\n// Poly points array\r\nSVG.PointArray = function(array, fallback) {\r\n  this.constructor.call(this, array, fallback || [[0,0]])\r\n}\r\n\r\n// Inherit from SVG.Array\r\nSVG.PointArray.prototype = new SVG.Array\r\n\r\nSVG.extend(SVG.PointArray, {\r\n  // Convert array to string\r\n  toString: function() {\r\n    // convert to a poly point string\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push(this.value[i].join(','))\r\n\r\n    return array.join(' ')\r\n  }\r\n  // Convert array to line object\r\n, toLine: function() {\r\n    return {\r\n      x1: this.value[0][0]\r\n    , y1: this.value[0][1]\r\n    , x2: this.value[1][0]\r\n    , y2: this.value[1][1]\r\n    }\r\n  }\r\n  // Get morphed array at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // generate morphed point string\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push([\r\n        this.value[i][0] + (this.destination[i][0] - this.value[i][0]) * pos\r\n      , this.value[i][1] + (this.destination[i][1] - this.value[i][1]) * pos\r\n      ])\r\n\r\n    return new SVG.PointArray(array)\r\n  }\r\n  // Parse point string\r\n, parse: function(array) {\r\n    var points = []\r\n\r\n    array = array.valueOf()\r\n\r\n    // if already is an array, no need to parse it\r\n    if (Array.isArray(array)) return array\r\n\r\n    // parse points\r\n    array = array.split(/\\s|,/)\r\n\r\n    // validate points - https://svgwg.org/svg2-draft/shapes.html#DataTypePoints\r\n    // Odd number of coordinates is an error. In such cases, drop the last odd coordinate.\r\n    if (array.length % 2 !== 0) array.pop()\r\n\r\n    // wrap points in two-tuples and parse points as floats\r\n    for(var i = 0, len = array.length; i < len; i = i + 2)\r\n      points.push([ parseFloat(array[i]), parseFloat(array[i+1]) ])\r\n\r\n    return points\r\n  }\r\n  // Move point string\r\n, move: function(x, y) {\r\n    var box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    // move every point\r\n    if (!isNaN(x) && !isNaN(y))\r\n      for (var i = this.value.length - 1; i >= 0; i--)\r\n        this.value[i] = [this.value[i][0] + x, this.value[i][1] + y]\r\n\r\n    return this\r\n  }\r\n  // Resize poly string\r\n, size: function(width, height) {\r\n    var i, box = this.bbox()\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.value.length - 1; i >= 0; i--) {\r\n      this.value[i][0] = ((this.value[i][0] - box.x) * width)  / box.width  + box.x\r\n      this.value[i][1] = ((this.value[i][1] - box.y) * height) / box.height + box.y\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Get bounding box of points\r\n, bbox: function() {\r\n    SVG.parser.poly.setAttribute('points', this.toString())\r\n\r\n    return SVG.parser.poly.getBBox()\r\n  }\r\n\r\n})\n// Path points array\r\nSVG.PathArray = function(array, fallback) {\r\n  this.constructor.call(this, array, fallback || [['M', 0, 0]])\r\n}\r\n\r\n// Inherit from SVG.Array\r\nSVG.PathArray.prototype = new SVG.Array\r\n\r\nSVG.extend(SVG.PathArray, {\r\n  // Convert array to string\r\n  toString: function() {\r\n    return arrayToString(this.value)\r\n  }\r\n  // Move path string\r\n, move: function(x, y) {\r\n    // get bounding box of current situation\r\n    var box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    if (!isNaN(x) && !isNaN(y)) {\r\n      // move every point\r\n      for (var l, i = this.value.length - 1; i >= 0; i--) {\r\n        l = this.value[i][0]\r\n\r\n        if (l == 'M' || l == 'L' || l == 'T')  {\r\n          this.value[i][1] += x\r\n          this.value[i][2] += y\r\n\r\n        } else if (l == 'H')  {\r\n          this.value[i][1] += x\r\n\r\n        } else if (l == 'V')  {\r\n          this.value[i][1] += y\r\n\r\n        } else if (l == 'C' || l == 'S' || l == 'Q')  {\r\n          this.value[i][1] += x\r\n          this.value[i][2] += y\r\n          this.value[i][3] += x\r\n          this.value[i][4] += y\r\n\r\n          if (l == 'C')  {\r\n            this.value[i][5] += x\r\n            this.value[i][6] += y\r\n          }\r\n\r\n        } else if (l == 'A')  {\r\n          this.value[i][6] += x\r\n          this.value[i][7] += y\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Resize path string\r\n, size: function(width, height) {\r\n    // get bounding box of current situation\r\n    var i, l, box = this.bbox()\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.value.length - 1; i >= 0; i--) {\r\n      l = this.value[i][0]\r\n\r\n      if (l == 'M' || l == 'L' || l == 'T')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][2] = ((this.value[i][2] - box.y) * height) / box.height + box.y\r\n\r\n      } else if (l == 'H')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n\r\n      } else if (l == 'V')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.y) * height) / box.height + box.y\r\n\r\n      } else if (l == 'C' || l == 'S' || l == 'Q')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][2] = ((this.value[i][2] - box.y) * height) / box.height + box.y\r\n        this.value[i][3] = ((this.value[i][3] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][4] = ((this.value[i][4] - box.y) * height) / box.height + box.y\r\n\r\n        if (l == 'C')  {\r\n          this.value[i][5] = ((this.value[i][5] - box.x) * width)  / box.width  + box.x\r\n          this.value[i][6] = ((this.value[i][6] - box.y) * height) / box.height + box.y\r\n        }\r\n\r\n      } else if (l == 'A')  {\r\n        // resize radii\r\n        this.value[i][1] = (this.value[i][1] * width)  / box.width\r\n        this.value[i][2] = (this.value[i][2] * height) / box.height\r\n\r\n        // move position values\r\n        this.value[i][6] = ((this.value[i][6] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][7] = ((this.value[i][7] - box.y) * height) / box.height + box.y\r\n      }\r\n\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Absolutize and parse path to array\r\n, parse: function(array) {\r\n    // if it's already a patharray, no need to parse it\r\n    if (array instanceof SVG.PathArray) return array.valueOf()\r\n\r\n    // prepare for parsing\r\n    var i, x0, y0, s, seg, arr\r\n      , x = 0\r\n      , y = 0\r\n      , paramCnt = { 'M':2, 'L':2, 'H':1, 'V':1, 'C':6, 'S':4, 'Q':4, 'T':2, 'A':7 }\r\n\r\n    if(typeof array == 'string'){\r\n\r\n      array = array\r\n        .replace(SVG.regex.negExp, 'X')         // replace all negative exponents with certain char\r\n        .replace(SVG.regex.pathLetters, ' $& ') // put some room between letters and numbers\r\n        .replace(SVG.regex.hyphen, ' -')        // add space before hyphen\r\n        .replace(SVG.regex.comma, ' ')          // unify all spaces\r\n        .replace(SVG.regex.X, 'e-')             // add back the expoent\r\n        .trim()                                 // trim\r\n        .split(SVG.regex.whitespaces)           // split into array\r\n\r\n      // at this place there could be parts like ['3.124.854.32'] because we could not determine the point as seperator till now\r\n      // we fix this elements in the next loop\r\n      for(i = array.length; --i;){\r\n        if(array[i].indexOf('.') != array[i].lastIndexOf('.')){\r\n          var split = array[i].split('.') // split at the point\r\n          var first = [split.shift(), split.shift()].join('.') // join the first number together\r\n          array.splice.apply(array, [i, 1].concat(first, split.map(function(el){ return '.'+el }))) // add first and all other entries back to array\r\n        }\r\n      }\r\n\r\n    }else{\r\n      array = array.reduce(function(prev, curr){\r\n        return [].concat.apply(prev, curr)\r\n      }, [])\r\n    }\r\n\r\n    // array now is an array containing all parts of a path e.g. ['M', '0', '0', 'L', '30', '30' ...]\r\n\r\n    var arr = []\r\n\r\n    do{\r\n\r\n      // Test if we have a path letter\r\n      if(SVG.regex.isPathLetter.test(array[0])){\r\n        s = array[0]\r\n        array.shift()\r\n      // If last letter was a move command and we got no new, it defaults to [L]ine\r\n      }else if(s == 'M'){\r\n        s = 'L'\r\n      }else if(s == 'm'){\r\n        s = 'l'\r\n      }\r\n\r\n      // add path letter as first element\r\n      seg = [s.toUpperCase()]\r\n\r\n      // push all necessary parameters to segment\r\n      for(i = 0; i < paramCnt[seg[0]]; ++i){\r\n        seg.push(parseFloat(array.shift()))\r\n      }\r\n\r\n      // upper case\r\n      if(s == seg[0]){\r\n\r\n        if(s == 'M' || s == 'L' || s == 'C' || s == 'Q' || s == 'S' || s == 'T'){\r\n          x = seg[paramCnt[seg[0]]-1]\r\n          y = seg[paramCnt[seg[0]]]\r\n        }else if(s == 'V'){\r\n          y = seg[1]\r\n        }else if(s == 'H'){\r\n          x = seg[1]\r\n        }else if(s == 'A'){\r\n          x = seg[6]\r\n          y = seg[7]\r\n        }\r\n\r\n      // lower case\r\n      }else{\r\n\r\n        // convert relative to absolute values\r\n        if(s == 'm' || s == 'l' || s == 'c' || s == 's' || s == 'q' || s == 't'){\r\n\r\n          seg[1] += x\r\n          seg[2] += y\r\n\r\n          if(seg[3] != null){\r\n            seg[3] += x\r\n            seg[4] += y\r\n          }\r\n\r\n          if(seg[5] != null){\r\n            seg[5] += x\r\n            seg[6] += y\r\n          }\r\n\r\n          // move pointer\r\n          x = seg[paramCnt[seg[0]]-1]\r\n          y = seg[paramCnt[seg[0]]]\r\n\r\n        }else if(s == 'v'){\r\n          seg[1] += y\r\n          y = seg[1]\r\n        }else if(s == 'h'){\r\n          seg[1] += x\r\n          x = seg[1]\r\n        }else if(s == 'a'){\r\n          seg[6] += x\r\n          seg[7] += y\r\n          x = seg[6]\r\n          y = seg[7]\r\n        }\r\n\r\n      }\r\n\r\n      if(seg[0] == 'M'){\r\n        x0 = x\r\n        y0 = y\r\n      }\r\n\r\n      if(seg[0] == 'Z'){\r\n        x = x0\r\n        y = y0\r\n      }\r\n\r\n      arr.push(seg)\r\n\r\n    }while(array.length)\r\n\r\n    return arr\r\n\r\n  }\r\n  // Get bounding box of path\r\n, bbox: function() {\r\n    SVG.parser.path.setAttribute('d', this.toString())\r\n\r\n    return SVG.parser.path.getBBox()\r\n  }\r\n\r\n})\n// Module for unit convertions\r\nSVG.Number = SVG.invent({\r\n  // Initialize\r\n  create: function(value, unit) {\r\n    // initialize defaults\r\n    this.value = 0\r\n    this.unit  = unit || ''\r\n\r\n    // parse value\r\n    if (typeof value === 'number') {\r\n      // ensure a valid numeric value\r\n      this.value = isNaN(value) ? 0 : !isFinite(value) ? (value < 0 ? -3.4e+38 : +3.4e+38) : value\r\n\r\n    } else if (typeof value === 'string') {\r\n      unit = value.match(SVG.regex.numberAndUnit)\r\n\r\n      if (unit) {\r\n        // make value numeric\r\n        this.value = parseFloat(unit[1])\r\n\r\n        // normalize\r\n        if (unit[5] == '%')\r\n          this.value /= 100\r\n        else if (unit[5] == 's')\r\n          this.value *= 1000\r\n\r\n        // store unit\r\n        this.unit = unit[5]\r\n      }\r\n\r\n    } else {\r\n      if (value instanceof SVG.Number) {\r\n        this.value = value.valueOf()\r\n        this.unit  = value.unit\r\n      }\r\n    }\r\n\r\n  }\r\n  // Add methods\r\n, extend: {\r\n    // Stringalize\r\n    toString: function() {\r\n      return (\r\n        this.unit == '%' ?\r\n          ~~(this.value * 1e8) / 1e6:\r\n        this.unit == 's' ?\r\n          this.value / 1e3 :\r\n          this.value\r\n      ) + this.unit\r\n    }\r\n  , toJSON: function() {\r\n      return this.toString()\r\n    }\r\n  , // Convert to primitive\r\n    valueOf: function() {\r\n      return this.value\r\n    }\r\n    // Add number\r\n  , plus: function(number) {\r\n      return new SVG.Number(this + new SVG.Number(number), this.unit)\r\n    }\r\n    // Subtract number\r\n  , minus: function(number) {\r\n      return this.plus(-new SVG.Number(number))\r\n    }\r\n    // Multiply number\r\n  , times: function(number) {\r\n      return new SVG.Number(this * new SVG.Number(number), this.unit)\r\n    }\r\n    // Divide number\r\n  , divide: function(number) {\r\n      return new SVG.Number(this / new SVG.Number(number), this.unit)\r\n    }\r\n    // Convert to different unit\r\n  , to: function(unit) {\r\n      var number = new SVG.Number(this)\r\n\r\n      if (typeof unit === 'string')\r\n        number.unit = unit\r\n\r\n      return number\r\n    }\r\n    // Make number morphable\r\n  , morph: function(number) {\r\n      this.destination = new SVG.Number(number)\r\n\r\n      return this\r\n    }\r\n    // Get morphed number at given position\r\n  , at: function(pos) {\r\n      // Make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // Generate new morphed number\r\n      return new SVG.Number(this.destination)\r\n          .minus(this)\r\n          .times(pos)\r\n          .plus(this)\r\n    }\r\n\r\n  }\r\n})\n\r\nSVG.Element = SVG.invent({\r\n  // Initialize node\r\n  create: function(node) {\r\n    // make stroke value accessible dynamically\r\n    this._stroke = SVG.defaults.attrs.stroke\r\n\r\n    // initialize data object\r\n    this.dom = {}\r\n\r\n    // create circular reference\r\n    if (this.node = node) {\r\n      this.type = node.nodeName\r\n      this.node.instance = this\r\n\r\n      // store current attribute value\r\n      this._stroke = node.getAttribute('stroke') || this._stroke\r\n    }\r\n  }\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return this.attr('x', x)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return this.attr('y', y)\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.x() + this.width() / 2 : this.x(x - this.width() / 2)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.y() + this.height() / 2 : this.y(y - this.height() / 2)\r\n    }\r\n    // Move element to given x and y values\r\n  , move: function(x, y) {\r\n      return this.x(x).y(y)\r\n    }\r\n    // Move element by its center\r\n  , center: function(x, y) {\r\n      return this.cx(x).cy(y)\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return this.attr('width', width)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return this.attr('height', height)\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this\r\n        .width(new SVG.Number(p.width))\r\n        .height(new SVG.Number(p.height))\r\n    }\r\n    // Clone element\r\n  , clone: function(parent) {\r\n      // clone element and assign new id\r\n      var clone = assignNewId(this.node.cloneNode(true))\r\n\r\n      // insert the clone in the given parent or after myself\r\n      if(parent) parent.add(clone)\r\n      else this.after(clone)\r\n\r\n      return clone\r\n    }\r\n    // Remove element\r\n  , remove: function() {\r\n      if (this.parent())\r\n        this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n    // Replace element\r\n  , replace: function(element) {\r\n      this.after(element).remove()\r\n\r\n      return element\r\n    }\r\n    // Add element to given container and return self\r\n  , addTo: function(parent) {\r\n      return parent.put(this)\r\n    }\r\n    // Add element to given container and return container\r\n  , putIn: function(parent) {\r\n      return parent.add(this)\r\n    }\r\n    // Get / set id\r\n  , id: function(id) {\r\n      return this.attr('id', id)\r\n    }\r\n    // Checks whether the given point inside the bounding box of the element\r\n  , inside: function(x, y) {\r\n      var box = this.bbox()\r\n\r\n      return x > box.x\r\n          && y > box.y\r\n          && x < box.x + box.width\r\n          && y < box.y + box.height\r\n    }\r\n    // Show element\r\n  , show: function() {\r\n      return this.style('display', '')\r\n    }\r\n    // Hide element\r\n  , hide: function() {\r\n      return this.style('display', 'none')\r\n    }\r\n    // Is element visible?\r\n  , visible: function() {\r\n      return this.style('display') != 'none'\r\n    }\r\n    // Return id on string conversion\r\n  , toString: function() {\r\n      return this.attr('id')\r\n    }\r\n    // Return array of classes on the node\r\n  , classes: function() {\r\n      var attr = this.attr('class')\r\n\r\n      return attr == null ? [] : attr.trim().split(/\\s+/)\r\n    }\r\n    // Return true if class exists on the node, false otherwise\r\n  , hasClass: function(name) {\r\n      return this.classes().indexOf(name) != -1\r\n    }\r\n    // Add class to the node\r\n  , addClass: function(name) {\r\n      if (!this.hasClass(name)) {\r\n        var array = this.classes()\r\n        array.push(name)\r\n        this.attr('class', array.join(' '))\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Remove class from the node\r\n  , removeClass: function(name) {\r\n      if (this.hasClass(name)) {\r\n        this.attr('class', this.classes().filter(function(c) {\r\n          return c != name\r\n        }).join(' '))\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Toggle the presence of a class on the node\r\n  , toggleClass: function(name) {\r\n      return this.hasClass(name) ? this.removeClass(name) : this.addClass(name)\r\n    }\r\n    // Get referenced element form attribute value\r\n  , reference: function(attr) {\r\n      return SVG.get(this.attr(attr))\r\n    }\r\n    // Returns the parent element instance\r\n  , parent: function(type) {\r\n      var parent = this\r\n\r\n      // check for parent\r\n      if(!parent.node.parentNode) return null\r\n\r\n      // get parent element\r\n      parent = SVG.adopt(parent.node.parentNode)\r\n\r\n      if(!type) return parent\r\n\r\n      // loop trough ancestors if type is given\r\n      while(parent && parent.node instanceof SVGElement){\r\n        if(typeof type === 'string' ? parent.matches(type) : parent instanceof type) return parent\r\n        parent = SVG.adopt(parent.node.parentNode)\r\n      }\r\n    }\r\n    // Get parent document\r\n  , doc: function() {\r\n      return this instanceof SVG.Doc ? this : this.parent(SVG.Doc)\r\n    }\r\n    // return array of all ancestors of given type up to the root svg\r\n  , parents: function(type) {\r\n      var parents = [], parent = this\r\n\r\n      do{\r\n        parent = parent.parent(type)\r\n        if(!parent || !parent.node) break\r\n\r\n        parents.push(parent)\r\n      } while(parent.parent)\r\n\r\n      return parents\r\n    }\r\n    // matches the element vs a css selector\r\n  , matches: function(selector){\r\n      return matches(this.node, selector)\r\n    }\r\n    // Returns the svg node to call native svg methods on it\r\n  , native: function() {\r\n      return this.node\r\n    }\r\n    // Import raw svg\r\n  , svg: function(svg) {\r\n      // create temporary holder\r\n      var well = document.createElement('svg')\r\n\r\n      // act as a setter if svg is given\r\n      if (svg && this instanceof SVG.Parent) {\r\n        // dump raw svg\r\n        well.innerHTML = '<svg>' + svg.replace(/\\n/, '').replace(/<(\\w+)([^<]+?)\\/>/g, '<$1$2></$1>') + '</svg>'\r\n\r\n        // transplant nodes\r\n        for (var i = 0, il = well.firstChild.childNodes.length; i < il; i++)\r\n          this.node.appendChild(well.firstChild.firstChild)\r\n\r\n      // otherwise act as a getter\r\n      } else {\r\n        // create a wrapping svg element in case of partial content\r\n        well.appendChild(svg = document.createElement('svg'))\r\n\r\n        // write svgjs data to the dom\r\n        this.writeDataToDom()\r\n\r\n        // insert a copy of this node\r\n        svg.appendChild(this.node.cloneNode(true))\r\n\r\n        // return target element\r\n        return well.innerHTML.replace(/^<svg>/, '').replace(/<\\/svg>$/, '')\r\n      }\r\n\r\n      return this\r\n    }\r\n  // write svgjs data to the dom\r\n  , writeDataToDom: function() {\r\n\r\n      // dump variables recursively\r\n      if(this.each || this.lines){\r\n        var fn = this.each ? this : this.lines();\r\n        fn.each(function(){\r\n          this.writeDataToDom()\r\n        })\r\n      }\r\n\r\n      // remove previously set data\r\n      this.node.removeAttribute('svgjs:data')\r\n\r\n      if(Object.keys(this.dom).length)\r\n        this.node.setAttribute('svgjs:data', JSON.stringify(this.dom)) // see #428\r\n\r\n      return this\r\n    }\r\n  // set given data to the elements data property\r\n  , setData: function(o){\r\n      this.dom = o\r\n      return this\r\n    }\r\n  , is: function(obj){\r\n      return is(this, obj)\r\n    }\r\n  }\r\n})\r\n\nSVG.easing = {\r\n  '-': function(pos){return pos}\r\n, '<>':function(pos){return -Math.cos(pos * Math.PI) / 2 + 0.5}\r\n, '>': function(pos){return  Math.sin(pos * Math.PI / 2)}\r\n, '<': function(pos){return -Math.cos(pos * Math.PI / 2) + 1}\r\n}\r\n\r\nSVG.morph = function(pos){\r\n  return function(from, to) {\r\n    return new SVG.MorphObj(from, to).at(pos)\r\n  }\r\n}\r\n\r\nSVG.Situation = SVG.invent({\r\n\r\n  create: function(o){\r\n    this.init = false\r\n    this.reversed = false\r\n    this.reversing = false\r\n\r\n    this.duration = new SVG.Number(o.duration).valueOf()\r\n    this.delay = new SVG.Number(o.delay).valueOf()\r\n\r\n    this.start = +new Date() + this.delay\r\n    this.finish = this.start + this.duration\r\n    this.ease = o.ease\r\n\r\n    this.loop = false\r\n    this.loops = false\r\n\r\n    this.animations = {\r\n      // functionToCall: [list of morphable objects]\r\n      // e.g. move: [SVG.Number, SVG.Number]\r\n    }\r\n\r\n    this.attrs = {\r\n      // holds all attributes which are not represented from a function svg.js provides\r\n      // e.g. someAttr: SVG.Number\r\n    }\r\n\r\n    this.styles = {\r\n      // holds all styles which should be animated\r\n      // e.g. fill-color: SVG.Color\r\n    }\r\n\r\n    this.transforms = [\r\n      // holds all transformations as transformation objects\r\n      // e.g. [SVG.Rotate, SVG.Translate, SVG.Matrix]\r\n    ]\r\n\r\n    this.once = {\r\n      // functions to fire at a specific position\r\n      // e.g. \"0.5\": function foo(){}\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\nSVG.Delay = function(delay){\r\n  this.delay = new SVG.Number(delay).valueOf()\r\n}\r\n\r\nSVG.FX = SVG.invent({\r\n\r\n  create: function(element) {\r\n    this._target = element\r\n    this.situations = []\r\n    this.active = false\r\n    this.situation = null\r\n    this.paused = false\r\n    this.lastPos = 0\r\n    this.pos = 0\r\n  }\r\n\r\n, extend: {\r\n\r\n    /**\r\n     * sets or returns the target of this animation\r\n     * @param o object || number In case of Object it holds all parameters. In case of number its the duration of the animation\r\n     * @param ease function || string Function which should be used for easing or easing keyword\r\n     * @param delay Number indicating the delay before the animation starts\r\n     * @return target || this\r\n     */\r\n    animate: function(o, ease, delay){\r\n\r\n      if(typeof o == 'object'){\r\n        ease = o.ease\r\n        delay = o.delay\r\n        o = o.duration\r\n      }\r\n\r\n      var situation = new SVG.Situation({\r\n        duration: o || 1000,\r\n        delay: delay || 0,\r\n        ease: SVG.easing[ease || '-'] || ease\r\n      })\r\n\r\n      this.queue(situation)\r\n\r\n      return this\r\n    }\r\n\r\n    /**\r\n     * sets a delay before the next element of the queue is called\r\n     * @param delay Duration of delay in milliseconds\r\n     * @return this.target()\r\n     */\r\n  , delay: function(delay){\r\n      var delay = new SVG.Delay(delay)\r\n\r\n      return this.queue(delay)\r\n    }\r\n\r\n    /**\r\n     * sets or returns the target of this animation\r\n     * @param null || target SVG.Elemenet which should be set as new target\r\n     * @return target || this\r\n     */\r\n  , target: function(target){\r\n      if(target && target instanceof SVG.Element){\r\n        this._target = target\r\n        return this\r\n      }\r\n\r\n      return this._target\r\n    }\r\n\r\n    // returns the position at a given time\r\n  , timeToPos: function(timestamp){\r\n      return (timestamp - this.situation.start) / (this.situation.duration)\r\n    }\r\n\r\n    // returns the timestamp from a given positon\r\n  , posToTime: function(pos){\r\n      return this.situation.duration * pos + this.situation.start\r\n    }\r\n\r\n    // starts the animationloop\r\n  , startAnimFrame: function(){\r\n      this.stopAnimFrame()\r\n      this.animationFrame = requestAnimationFrame(function(){ this.step() }.bind(this))\r\n    }\r\n\r\n    // cancels the animationframe\r\n  , stopAnimFrame: function(){\r\n      cancelAnimationFrame(this.animationFrame)\r\n    }\r\n\r\n    // kicks off the animation - only does something when the queue is curretly not active and at least one situation is set\r\n  , start: function(){\r\n      // dont start if already started\r\n      if(!this.active && this.situation){\r\n        this.situation.start = +new Date + this.situation.delay\r\n        this.situation.finish = this.situation.start + this.situation.duration\r\n\r\n        this.initAnimations()\r\n        this.active = true\r\n        this.startAnimFrame()\r\n      }\r\n\r\n      return this\r\n    }\r\n\r\n    /**\r\n     * adds a function / Situation to the animation queue\r\n     * @param fn function / situation to add\r\n     * @return this\r\n     */\r\n  , queue: function(fn){\r\n      if(typeof fn == 'function' || fn instanceof SVG.Situation || fn instanceof SVG.Delay)\r\n        this.situations.push(fn)\r\n\r\n      if(!this.situation) this.situation = this.situations.shift()\r\n\r\n      return this\r\n    }\r\n\r\n    /**\r\n     * pulls next element from the queue and execute it\r\n     * @return this\r\n     */\r\n  , dequeue: function(){\r\n      // stop current animation\r\n      this.situation && this.situation.stop && this.situation.stop()\r\n\r\n      // get next animation from queue\r\n      this.situation = this.situations.shift()\r\n\r\n      if(this.situation){\r\n\r\n        var fn = function(){\r\n          if(this.situation instanceof SVG.Situation)\r\n            this.initAnimations().at(0)\r\n          else if(this.situation instanceof SVG.Delay)\r\n            this.dequeue()\r\n          else\r\n            this.situation.call(this)\r\n        }.bind(this)\r\n\r\n        // start next animation\r\n        if(this.situation.delay){\r\n          setTimeout(function(){fn()}, this.situation.delay)\r\n        }else{\r\n          fn()\r\n        }\r\n\r\n      }\r\n\r\n      return this\r\n    }\r\n\r\n    // updates all animations to the current state of the element\r\n    // this is important when one property could be changed from another property\r\n  , initAnimations: function() {\r\n      var i\r\n      var s = this.situation\r\n\r\n      if(s.init) return this\r\n\r\n      for(i in s.animations){\r\n\r\n        if(i == 'viewbox'){\r\n          s.animations[i] = this.target().viewbox().morph(s.animations[i])\r\n        }else{\r\n\r\n          // TODO: this is not a clean clone of the array. We may have some unchecked references\r\n          s.animations[i].value = (i == 'plot' ? this.target().array().value : this.target()[i]())\r\n\r\n          // sometimes we get back an object and not the real value, fix this\r\n          if(s.animations[i].value.value){\r\n            s.animations[i].value = s.animations[i].value.value\r\n          }\r\n\r\n          if(s.animations[i].relative)\r\n            s.animations[i].destination.value = s.animations[i].destination.value + s.animations[i].value\r\n\r\n        }\r\n\r\n      }\r\n\r\n      for(i in s.attrs){\r\n        if(s.attrs[i] instanceof SVG.Color){\r\n          var color = new SVG.Color(this.target().attr(i))\r\n          s.attrs[i].r = color.r\r\n          s.attrs[i].g = color.g\r\n          s.attrs[i].b = color.b\r\n        }else{\r\n          s.attrs[i].value = this.target().attr(i)// + s.attrs[i].value\r\n        }\r\n      }\r\n\r\n      for(i in s.styles){\r\n        s.styles[i].value = this.target().style(i)\r\n      }\r\n\r\n      s.initialTransformation = this.target().matrixify()\r\n\r\n      s.init = true\r\n      return this\r\n    }\r\n  , clearQueue: function(){\r\n      this.situations = []\r\n      return this\r\n    }\r\n  , clearCurrent: function(){\r\n      this.situation = null\r\n      return this\r\n    }\r\n    /** stops the animation immediately\r\n     * @param jumpToEnd A Boolean indicating whether to complete the current animation immediately.\r\n     * @param clearQueue A Boolean indicating whether to remove queued animation as well.\r\n     * @return this\r\n     */\r\n  , stop: function(jumpToEnd, clearQueue){\r\n      if(!this.active) this.start()\r\n\r\n      if(clearQueue){\r\n        this.clearQueue()\r\n      }\r\n\r\n      this.active = false\r\n\r\n      if(jumpToEnd && this.situation){\r\n\r\n        this.situation.loop = false\r\n\r\n        if(this.situation.loops % 2 == 0 && this.situation.reversing){\r\n          this.situation.reversed = true\r\n        }\r\n\r\n        this.at(1)\r\n\r\n      }\r\n\r\n      this.stopAnimFrame()\r\n      clearTimeout(this.timeout)\r\n\r\n      return this.clearCurrent()\r\n    }\r\n\r\n    /** resets the element to the state where the current element has started\r\n     * @return this\r\n     */\r\n  , reset: function(){\r\n      if(this.situation){\r\n        var temp = this.situation\r\n        this.stop()\r\n        this.situation = temp\r\n        this.at(0)\r\n      }\r\n      return this\r\n    }\r\n\r\n    // Stop the currently-running animation, remove all queued animations, and complete all animations for the element.\r\n  , finish: function(){\r\n\r\n      this.stop(true, false)\r\n\r\n      while(this.dequeue().situation && this.stop(true, false));\r\n\r\n      this.clearQueue().clearCurrent()\r\n\r\n      return this\r\n    }\r\n\r\n    // set the internal animation pointer to the specified position and updates the visualisation\r\n  , at: function(pos){\r\n      this.pos = pos\r\n      this.situation.start = +new Date - pos * this.situation.duration\r\n      this.situation.finish = this.situation.start + this.situation.duration\r\n      return this.step(true)\r\n    }\r\n\r\n    // speeds up the animation by the given factor\r\n    // this changes the duration of the animation\r\n  , speed: function(speed){\r\n      this.situation.duration = this.situation.duration * this.pos + (1-this.pos) * this.situation.duration / speed\r\n      this.situation.finish = this.situation.start + this.situation.duration\r\n      return this.at(this.pos)\r\n    }\r\n    // Make loopable\r\n  , loop: function(times, reverse) {\r\n      // store current loop and total loops\r\n      this.situation.loop = this.situation.loops = times || true\r\n\r\n      if(reverse) this.last().reversing = true\r\n      return this\r\n    }\r\n\r\n    // pauses the animation\r\n  , pause: function(){\r\n      this.paused = true\r\n      this.stopAnimFrame()\r\n      clearTimeout(this.timeout)\r\n      return this\r\n    }\r\n\r\n    // unpause the animation\r\n  , play: function(){\r\n      if(!this.paused) return this\r\n      this.paused = false\r\n      return this.at(this.pos)\r\n    }\r\n\r\n    /**\r\n     * toggle or set the direction of the animation\r\n     * true sets direction to backwards while false sets it to forwards\r\n     * @param reversed Boolean indicating whether to reverse the animation or not (default: toggle the reverse status)\r\n     * @return this\r\n     */\r\n  , reverse: function(reversed){\r\n      var c = this.last()\r\n\r\n      if(typeof reversed == 'undefined') c.reversed = !c.reversed\r\n      else c.reversed = reversed\r\n\r\n      return this\r\n    }\r\n\r\n\r\n    /**\r\n     * returns a float from 0-1 indicating the progress of the current animation\r\n     * @param eased Boolean indicating whether the returned position should be eased or not\r\n     * @return number\r\n     */\r\n  , progress: function(easeIt){\r\n      return easeIt ? this.situation.ease(this.pos) : this.pos\r\n    }\r\n\r\n    /**\r\n     * adds a callback function which is called when the current animation is finished\r\n     * @param fn Function which should be executed as callback\r\n     * @return number\r\n     */\r\n  , after: function(fn){\r\n      var c = this.last()\r\n        , wrapper = function wrapper(e){\r\n            if(e.detail.situation == c){\r\n              fn.call(this, c)\r\n              this.off('finished.fx', wrapper) // prevent memory leak\r\n            }\r\n          }\r\n\r\n      this.target().on('finished.fx', wrapper)\r\n      return this\r\n    }\r\n\r\n    // adds a callback which is called whenever one animation step is performed\r\n  , during: function(fn){\r\n      var c = this.last()\r\n        , wrapper = function(e){\r\n            if(e.detail.situation == c){\r\n              fn.call(this, e.detail.pos, SVG.morph(e.detail.pos), e.detail.eased, c)\r\n            }\r\n          }\r\n\r\n      // see above\r\n      this.target().off('during.fx', wrapper).on('during.fx', wrapper)\r\n\r\n      return this.after(function(){\r\n        this.off('during.fx', wrapper)\r\n      })\r\n    }\r\n\r\n    // calls after ALL animations in the queue are finished\r\n  , afterAll: function(fn){\r\n      var wrapper = function wrapper(e){\r\n            fn.call(this)\r\n            this.off('allfinished.fx', wrapper)\r\n          }\r\n\r\n      // see above\r\n      this.target().off('allfinished.fx', wrapper).on('allfinished.fx', wrapper)\r\n      return this\r\n    }\r\n\r\n    // calls on every animation step for all animations\r\n  , duringAll: function(fn){\r\n      var wrapper = function(e){\r\n            fn.call(this, e.detail.pos, SVG.morph(e.detail.pos), e.detail.eased, e.detail.situation)\r\n          }\r\n\r\n      this.target().off('during.fx', wrapper).on('during.fx', wrapper)\r\n\r\n      return this.afterAll(function(){\r\n        this.off('during.fx', wrapper)\r\n      })\r\n    }\r\n\r\n  , last: function(){\r\n      return this.situations.length ? this.situations[this.situations.length-1] : this.situation\r\n    }\r\n\r\n    // adds one property to the animations\r\n  , add: function(method, args, type){\r\n      this.last()[type || 'animations'][method] = args\r\n      setTimeout(function(){this.start()}.bind(this), 0)\r\n      return this\r\n    }\r\n\r\n    /** perform one step of the animation\r\n     *  @param ignoreTime Boolean indicating whether to ignore time and use position directly or recalculate position based on time\r\n     *  @return this\r\n     */\r\n  , step: function(ignoreTime){\r\n\r\n      // convert current time to position\r\n      if(!ignoreTime) this.pos = this.timeToPos(+new Date)\r\n\r\n      if(this.pos >= 1 && (this.situation.loop === true || (typeof this.situation.loop == 'number' && --this.situation.loop))){\r\n\r\n        if(this.situation.reversing){\r\n          this.situation.reversed = !this.situation.reversed\r\n        }\r\n        return this.at(this.pos-1)\r\n      }\r\n\r\n      if(this.situation.reversed) this.pos = 1 - this.pos\r\n\r\n      // correct position\r\n      if(this.pos > 1)this.pos = 1\r\n      if(this.pos < 0)this.pos = 0\r\n\r\n      // apply easing\r\n      var eased = this.situation.ease(this.pos)\r\n\r\n      // call once-callbacks\r\n      for(var i in this.situation.once){\r\n        if(i > this.lastPos && i <= eased){\r\n          this.situation.once[i].call(this.target(), this.pos, eased)\r\n          delete this.situation.once[i]\r\n        }\r\n      }\r\n\r\n      // fire during callback with position, eased position and current situation as parameter\r\n      if(this.active) this.target().fire('during', {pos: this.pos, eased: eased, fx: this, situation: this.situation})\r\n\r\n      // the user may call stop or finish in the during callback\r\n      // so make sure that we still have a valid situation\r\n      if(!this.situation){\r\n        return this\r\n      }\r\n\r\n      // apply the actual animation to every property\r\n      this.eachAt()\r\n\r\n      // do final code when situation is finished\r\n      if((this.pos == 1 && !this.situation.reversed) || (this.situation.reversed && this.pos == 0)){\r\n\r\n        // stop animation callback\r\n        this.stopAnimFrame()\r\n\r\n        // fire finished callback with current situation as parameter\r\n        this.target().fire('finished', {fx:this, situation: this.situation})\r\n\r\n        if(!this.situations.length){\r\n          this.target().fire('allfinished')\r\n          this.target().off('.fx') // there shouldnt be any binding left, but to make sure...\r\n          this.active = false\r\n        }\r\n\r\n        // start next animation\r\n        if(this.active) this.dequeue()\r\n        else this.clearCurrent()\r\n\r\n      }else if(!this.paused && this.active){\r\n        // we continue animating when we are not at the end\r\n        this.startAnimFrame()\r\n      }\r\n\r\n      // save last eased position for once callback triggering\r\n      this.lastPos = eased\r\n      return this\r\n\r\n    }\r\n\r\n    // calculates the step for every property and calls block with it\r\n  , eachAt: function(){\r\n      var i, at, self = this, target = this.target(), s = this.situation\r\n\r\n      // apply animations which can be called trough a method\r\n      for(i in s.animations){\r\n\r\n        at = [].concat(s.animations[i]).map(function(el){\r\n          return el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target[i].apply(target, at)\r\n\r\n      }\r\n\r\n      // apply animation which has to be applied with attr()\r\n      for(i in s.attrs){\r\n\r\n        at = [i].concat(s.attrs[i]).map(function(el){\r\n          return el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target.attr.apply(target, at)\r\n\r\n      }\r\n\r\n      // apply animation which has to be applied with style()\r\n      for(i in s.styles){\r\n\r\n        at = [i].concat(s.styles[i]).map(function(el){\r\n          return el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target.style.apply(target, at)\r\n\r\n      }\r\n\r\n      // animate initialTransformation which has to be chained\r\n      if(s.transforms.length){\r\n\r\n        // get inital initialTransformation\r\n        at = s.initialTransformation\r\n        for(i in s.transforms){\r\n\r\n          // get next transformation in chain\r\n          var a = s.transforms[i]\r\n\r\n          // multiply matrix directly\r\n          if(a instanceof SVG.Matrix){\r\n\r\n            if(a.relative){\r\n              at = at.multiply(a.at(s.ease(this.pos)))\r\n            }else{\r\n              at = at.morph(a).at(s.ease(this.pos))\r\n            }\r\n            continue\r\n          }\r\n\r\n          // when transformation is absolute we have to reset the needed transformation first\r\n          if(!a.relative)\r\n            a.undo(at.extract())\r\n\r\n          // and reapply it after\r\n          at = at.multiply(a.at(s.ease(this.pos)))\r\n\r\n        }\r\n\r\n        // set new matrix on element\r\n        target.matrix(at)\r\n      }\r\n\r\n      return this\r\n\r\n    }\r\n\r\n\r\n    // adds an once-callback which is called at a specific position and never again\r\n  , once: function(pos, fn, isEased){\r\n\r\n      if(!isEased)pos = this.situation.ease(pos)\r\n\r\n      this.situation.once[pos] = fn\r\n\r\n      return this\r\n    }\r\n\r\n  }\r\n\r\n, parent: SVG.Element\r\n\r\n  // Add method to parent elements\r\n, construct: {\r\n    // Get fx module or create a new one, then animate with given duration and ease\r\n    animate: function(o, ease, delay) {\r\n      return (this.fx || (this.fx = new SVG.FX(this))).animate(o, ease, delay)\r\n    }\r\n  , delay: function(delay){\r\n      return (this.fx || (this.fx = new SVG.FX(this))).delay(delay)\r\n    }\r\n  , stop: function(jumpToEnd, clearQueue) {\r\n      if (this.fx)\r\n        this.fx.stop(jumpToEnd, clearQueue)\r\n\r\n      return this\r\n    }\r\n  , finish: function() {\r\n      if (this.fx)\r\n        this.fx.finish()\r\n\r\n      return this\r\n    }\r\n    // Pause current animation\r\n  , pause: function() {\r\n      if (this.fx)\r\n        this.fx.pause()\r\n\r\n      return this\r\n    }\r\n    // Play paused current animation\r\n  , play: function() {\r\n      if (this.fx)\r\n        this.fx.play()\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\r\n// MorphObj is used whenever no morphable object is given\r\nSVG.MorphObj = SVG.invent({\r\n\r\n  create: function(from, to){\r\n    // prepare color for morphing\r\n    if(SVG.Color.isColor(to)) return new SVG.Color(from).morph(to)\r\n    // prepare number for morphing\r\n    if(SVG.regex.numberAndUnit.test(to)) return new SVG.Number(from).morph(to)\r\n\r\n    // prepare for plain morphing\r\n    this.value = 0\r\n    this.destination = to\r\n  }\r\n\r\n, extend: {\r\n    at: function(pos, real){\r\n      return real < 1 ? this.value : this.destination\r\n    },\r\n\r\n    valueOf: function(){\r\n      return this.value\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.FX, {\r\n  // Add animatable attributes\r\n  attr: function(a, v, relative) {\r\n    // apply attributes individually\r\n    if (typeof a == 'object') {\r\n      for (var key in a)\r\n        this.attr(key, a[key])\r\n\r\n    } else {\r\n      // the MorphObj takes care about the right function used\r\n      this.add(a, new SVG.MorphObj(null, v), 'attrs')\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Add animatable styles\r\n, style: function(s, v) {\r\n    if (typeof s == 'object')\r\n      for (var key in s)\r\n        this.style(key, s[key])\r\n\r\n    else\r\n      this.add(s, new SVG.MorphObj(null, v), 'styles')\r\n\r\n    return this\r\n  }\r\n  // Animatable x-axis\r\n, x: function(x, relative) {\r\n    if(this.target() instanceof SVG.G){\r\n      this.transform({x:x}, relative)\r\n      return this\r\n    }\r\n\r\n    var num = new SVG.Number().morph(x)\r\n    num.relative = relative\r\n    return this.add('x', num)\r\n  }\r\n  // Animatable y-axis\r\n, y: function(y, relative) {\r\n    if(this.target() instanceof SVG.G){\r\n      this.transform({y:y}, relative)\r\n      return this\r\n    }\r\n\r\n    var num = new SVG.Number().morph(y)\r\n    num.relative = relative\r\n    return this.add('y', num)\r\n  }\r\n  // Animatable center x-axis\r\n, cx: function(x) {\r\n    return this.add('cx', new SVG.Number().morph(x))\r\n  }\r\n  // Animatable center y-axis\r\n, cy: function(y) {\r\n    return this.add('cy', new SVG.Number().morph(y))\r\n  }\r\n  // Add animatable move\r\n, move: function(x, y) {\r\n    return this.x(x).y(y)\r\n  }\r\n  // Add animatable center\r\n, center: function(x, y) {\r\n    return this.cx(x).cy(y)\r\n  }\r\n  // Add animatable size\r\n, size: function(width, height) {\r\n    if (this.target() instanceof SVG.Text) {\r\n      // animate font size for Text elements\r\n      this.attr('font-size', width)\r\n\r\n    } else {\r\n      // animate bbox based size for all other elements\r\n      var box\r\n\r\n      if(!width || !height){\r\n        box = this.target().bbox()\r\n      }\r\n\r\n      if(!width){\r\n        width = box.width / box.height  * height\r\n      }\r\n\r\n      if(!height){\r\n        height = box.height / box.width  * width\r\n      }\r\n\r\n      this.add('width' , new SVG.Number().morph(width))\r\n          .add('height', new SVG.Number().morph(height))\r\n\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Add animatable plot\r\n, plot: function(p) {\r\n    return this.add('plot', this.target().array().morph(p))\r\n  }\r\n  // Add leading method\r\n, leading: function(value) {\r\n    return this.target().leading ?\r\n      this.add('leading', new SVG.Number().morph(value)) :\r\n      this\r\n  }\r\n  // Add animatable viewbox\r\n, viewbox: function(x, y, width, height) {\r\n    if (this.target() instanceof SVG.Container) {\r\n      this.add('viewbox', new SVG.ViewBox(x, y, width, height))\r\n    }\r\n\r\n    return this\r\n  }\r\n, update: function(o) {\r\n    if (this.target() instanceof SVG.Stop) {\r\n      if (typeof o == 'number' || o instanceof SVG.Number) {\r\n        return this.update({\r\n          offset:  arguments[0]\r\n        , color:   arguments[1]\r\n        , opacity: arguments[2]\r\n        })\r\n      }\r\n\r\n      if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n      if (o.color   != null) this.attr('stop-color', o.color)\r\n      if (o.offset  != null) this.attr('offset', o.offset)\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.BBox = SVG.invent({\r\n  // Initialize\r\n  create: function(element) {\r\n    // get values if element is given\r\n    if (element) {\r\n      var box\r\n\r\n      // yes this is ugly, but Firefox can be a bitch when it comes to elements that are not yet rendered\r\n      try {\r\n\r\n        // the element is NOT in the dom, throw error\r\n        if(!document.documentElement.contains(element.node)) throw new Exception('Element not in the dom')\r\n\r\n        // find native bbox\r\n        box = element.node.getBBox()\r\n      } catch(e) {\r\n        if(element instanceof SVG.Shape){\r\n          var clone = element.clone(SVG.parser.draw).show()\r\n          box = clone.bbox()\r\n          clone.remove()\r\n        }else{\r\n          box = {\r\n            x:      element.node.clientLeft\r\n          , y:      element.node.clientTop\r\n          , width:  element.node.clientWidth\r\n          , height: element.node.clientHeight\r\n          }\r\n        }\r\n      }\r\n\r\n      // plain x and y\r\n      this.x = box.x\r\n      this.y = box.y\r\n\r\n      // plain width and height\r\n      this.width  = box.width\r\n      this.height = box.height\r\n    }\r\n\r\n    // add center, right and bottom\r\n    fullBox(this)\r\n  }\r\n\r\n  // Define Parent\r\n, parent: SVG.Element\r\n\r\n  // Constructor\r\n, construct: {\r\n    // Get bounding box\r\n    bbox: function() {\r\n      return new SVG.BBox(this)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.TBox = SVG.invent({\r\n  // Initialize\r\n  create: function(element) {\r\n    // get values if element is given\r\n    if (element) {\r\n      var t   = element.ctm().extract()\r\n        , box = element.bbox()\r\n\r\n      // width and height including transformations\r\n      this.width  = box.width  * t.scaleX\r\n      this.height = box.height * t.scaleY\r\n\r\n      // x and y including transformations\r\n      this.x = box.x + t.x\r\n      this.y = box.y + t.y\r\n    }\r\n\r\n    // add center, right and bottom\r\n    fullBox(this)\r\n  }\r\n\r\n  // Define Parent\r\n, parent: SVG.Element\r\n\r\n  // Constructor\r\n, construct: {\r\n    // Get transformed bounding box\r\n    tbox: function() {\r\n      return new SVG.TBox(this)\r\n    }\r\n  }\r\n\r\n})\r\n\r\n\r\nSVG.RBox = SVG.invent({\r\n  // Initialize\r\n  create: function(element) {\r\n    if (element) {\r\n      var e    = element.doc().parent()\r\n        , box  = element.node.getBoundingClientRect()\r\n        , zoom = 1\r\n\r\n      // get screen offset\r\n      this.x = box.left\r\n      this.y = box.top\r\n\r\n      // subtract parent offset\r\n      this.x -= e.offsetLeft\r\n      this.y -= e.offsetTop\r\n\r\n      while (e = e.offsetParent) {\r\n        this.x -= e.offsetLeft\r\n        this.y -= e.offsetTop\r\n      }\r\n\r\n      // calculate cumulative zoom from svg documents\r\n      e = element\r\n      while (e.parent && (e = e.parent())) {\r\n        if (e.viewbox) {\r\n          zoom *= e.viewbox().zoom\r\n          this.x -= e.x() || 0\r\n          this.y -= e.y() || 0\r\n        }\r\n      }\r\n\r\n      // recalculate viewbox distortion\r\n      this.width  = box.width  /= zoom\r\n      this.height = box.height /= zoom\r\n    }\r\n\r\n    // add center, right and bottom\r\n    fullBox(this)\r\n\r\n    // offset by window scroll position, because getBoundingClientRect changes when window is scrolled\r\n    this.x += window.pageXOffset\r\n    this.y += window.pageYOffset\r\n  }\r\n\r\n  // define Parent\r\n, parent: SVG.Element\r\n\r\n  // Constructor\r\n, construct: {\r\n    // Get rect box\r\n    rbox: function() {\r\n      return new SVG.RBox(this)\r\n    }\r\n  }\r\n\r\n})\r\n\r\n// Add universal merge method\r\n;[SVG.BBox, SVG.TBox, SVG.RBox].forEach(function(c) {\r\n\r\n  SVG.extend(c, {\r\n    // Merge rect box with another, return a new instance\r\n    merge: function(box) {\r\n      var b = new c()\r\n\r\n      // merge boxes\r\n      b.x      = Math.min(this.x, box.x)\r\n      b.y      = Math.min(this.y, box.y)\r\n      b.width  = Math.max(this.x + this.width,  box.x + box.width)  - b.x\r\n      b.height = Math.max(this.y + this.height, box.y + box.height) - b.y\r\n\r\n      return fullBox(b)\r\n    }\r\n\r\n  })\r\n\r\n})\r\n\nSVG.Matrix = SVG.invent({\r\n  // Initialize\r\n  create: function(source) {\r\n    var i, base = arrayToMatrix([1, 0, 0, 1, 0, 0])\r\n\r\n    // ensure source as object\r\n    source = source instanceof SVG.Element ?\r\n      source.matrixify() :\r\n    typeof source === 'string' ?\r\n      stringToMatrix(source) :\r\n    arguments.length == 6 ?\r\n      arrayToMatrix([].slice.call(arguments)) :\r\n    typeof source === 'object' ?\r\n      source : base\r\n\r\n    // merge source\r\n    for (i = abcdef.length - 1; i >= 0; --i)\r\n      this[abcdef[i]] = source && typeof source[abcdef[i]] === 'number' ?\r\n        source[abcdef[i]] : base[abcdef[i]]\r\n  }\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Extract individual transformations\r\n    extract: function() {\r\n      // find delta transform points\r\n      var px    = deltaTransformPoint(this, 0, 1)\r\n        , py    = deltaTransformPoint(this, 1, 0)\r\n        , skewX = 180 / Math.PI * Math.atan2(px.y, px.x) - 90\r\n\r\n      return {\r\n        // translation\r\n        x:        this.e\r\n      , y:        this.f\r\n      , transformedX:(this.e * Math.cos(skewX * Math.PI / 180) + this.f * Math.sin(skewX * Math.PI / 180)) / Math.sqrt(this.a * this.a + this.b * this.b)\r\n      , transformedY:(this.f * Math.cos(skewX * Math.PI / 180) + this.e * Math.sin(-skewX * Math.PI / 180)) / Math.sqrt(this.c * this.c + this.d * this.d)\r\n        // skew\r\n      , skewX:    -skewX\r\n      , skewY:    180 / Math.PI * Math.atan2(py.y, py.x)\r\n        // scale\r\n      , scaleX:   Math.sqrt(this.a * this.a + this.b * this.b)\r\n      , scaleY:   Math.sqrt(this.c * this.c + this.d * this.d)\r\n        // rotation\r\n      , rotation: skewX\r\n      , a: this.a\r\n      , b: this.b\r\n      , c: this.c\r\n      , d: this.d\r\n      , e: this.e\r\n      , f: this.f\r\n      , matrix: new SVG.Matrix(this)\r\n      }\r\n    }\r\n    // Clone matrix\r\n  , clone: function() {\r\n      return new SVG.Matrix(this)\r\n    }\r\n    // Morph one matrix into another\r\n  , morph: function(matrix) {\r\n      // store new destination\r\n      this.destination = new SVG.Matrix(matrix)\r\n\r\n      return this\r\n    }\r\n    // Get morphed matrix at a given position\r\n  , at: function(pos) {\r\n      // make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // calculate morphed matrix at a given position\r\n      var matrix = new SVG.Matrix({\r\n        a: this.a + (this.destination.a - this.a) * pos\r\n      , b: this.b + (this.destination.b - this.b) * pos\r\n      , c: this.c + (this.destination.c - this.c) * pos\r\n      , d: this.d + (this.destination.d - this.d) * pos\r\n      , e: this.e + (this.destination.e - this.e) * pos\r\n      , f: this.f + (this.destination.f - this.f) * pos\r\n      })\r\n\r\n      // process parametric rotation if present\r\n      if (this.param && this.param.to) {\r\n        // calculate current parametric position\r\n        var param = {\r\n          rotation: this.param.from.rotation + (this.param.to.rotation - this.param.from.rotation) * pos\r\n        , cx:       this.param.from.cx\r\n        , cy:       this.param.from.cy\r\n        }\r\n\r\n        // rotate matrix\r\n        matrix = matrix.rotate(\r\n          (this.param.to.rotation - this.param.from.rotation * 2) * pos\r\n        , param.cx\r\n        , param.cy\r\n        )\r\n\r\n        // store current parametric values\r\n        matrix.param = param\r\n      }\r\n\r\n      return matrix\r\n    }\r\n    // Multiplies by given matrix\r\n  , multiply: function(matrix) {\r\n      return new SVG.Matrix(this.native().multiply(parseMatrix(matrix).native()))\r\n    }\r\n    // Inverses matrix\r\n  , inverse: function() {\r\n      return new SVG.Matrix(this.native().inverse())\r\n    }\r\n    // Translate matrix\r\n  , translate: function(x, y) {\r\n      return new SVG.Matrix(this.native().translate(x || 0, y || 0))\r\n    }\r\n    // Scale matrix\r\n  , scale: function(x, y, cx, cy) {\r\n      // support universal scale\r\n      if (arguments.length == 1 || arguments.length == 3)\r\n        y = x\r\n      if (arguments.length == 3) {\r\n        cy = cx\r\n        cx = y\r\n      }\r\n\r\n      return this.around(cx, cy, new SVG.Matrix(x, 0, 0, y, 0, 0))\r\n    }\r\n    // Rotate matrix\r\n  , rotate: function(r, cx, cy) {\r\n      // convert degrees to radians\r\n      r = SVG.utils.radians(r)\r\n\r\n      return this.around(cx, cy, new SVG.Matrix(Math.cos(r), Math.sin(r), -Math.sin(r), Math.cos(r), 0, 0))\r\n    }\r\n    // Flip matrix on x or y, at a given offset\r\n  , flip: function(a, o) {\r\n      return a == 'x' ? this.scale(-1, 1, o, 0) : this.scale(1, -1, 0, o)\r\n    }\r\n    // Skew\r\n  , skew: function(x, y, cx, cy) {\r\n      return this.around(cx, cy, this.native().skewX(x || 0).skewY(y || 0))\r\n    }\r\n    // SkewX\r\n  , skewX: function(x, cx, cy) {\r\n      return this.around(cx, cy, this.native().skewX(x || 0))\r\n    }\r\n    // SkewY\r\n  , skewY: function(y, cx, cy) {\r\n      return this.around(cx, cy, this.native().skewY(y || 0))\r\n    }\r\n    // Transform around a center point\r\n  , around: function(cx, cy, matrix) {\r\n      return this\r\n        .multiply(new SVG.Matrix(1, 0, 0, 1, cx || 0, cy || 0))\r\n        .multiply(matrix)\r\n        .multiply(new SVG.Matrix(1, 0, 0, 1, -cx || 0, -cy || 0))\r\n    }\r\n    // Convert to native SVGMatrix\r\n  , native: function() {\r\n      // create new matrix\r\n      var matrix = SVG.parser.native.createSVGMatrix()\r\n\r\n      // update with current values\r\n      for (var i = abcdef.length - 1; i >= 0; i--)\r\n        matrix[abcdef[i]] = this[abcdef[i]]\r\n\r\n      return matrix\r\n    }\r\n    // Convert matrix to string\r\n  , toString: function() {\r\n      return 'matrix(' + this.a + ',' + this.b + ',' + this.c + ',' + this.d + ',' + this.e + ',' + this.f + ')'\r\n    }\r\n  }\r\n\r\n  // Define parent\r\n, parent: SVG.Element\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Get current matrix\r\n    ctm: function() {\r\n      return new SVG.Matrix(this.node.getCTM())\r\n    },\r\n    // Get current screen matrix\r\n    screenCTM: function() {\r\n      return new SVG.Matrix(this.node.getScreenCTM())\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\nSVG.Point = SVG.invent({\r\n  // Initialize\r\n  create: function(x,y) {\r\n    var i, source, base = {x:0, y:0}\r\n\r\n    // ensure source as object\r\n    source = Array.isArray(x) ?\r\n      {x:x[0], y:x[1]} :\r\n    typeof x === 'object' ?\r\n      {x:x.x, y:x.y} :\r\n    y != null ?\r\n      {x:x, y:y} : base\r\n\r\n    // merge source\r\n    this.x = source.x\r\n    this.y = source.y\r\n  }\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Clone point\r\n    clone: function() {\r\n      return new SVG.Point(this)\r\n    }\r\n    // Morph one point into another\r\n  , morph: function(point) {\r\n      // store new destination\r\n      this.destination = new SVG.Point(point)\r\n\r\n      return this\r\n    }\r\n    // Get morphed point at a given position\r\n  , at: function(pos) {\r\n      // make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // calculate morphed matrix at a given position\r\n      var point = new SVG.Point({\r\n        x: this.x + (this.destination.x - this.x) * pos\r\n      , y: this.y + (this.destination.y - this.y) * pos\r\n      })\r\n\r\n      return point\r\n    }\r\n    // Convert to native SVGPoint\r\n  , native: function() {\r\n      // create new point\r\n      var point = SVG.parser.native.createSVGPoint()\r\n\r\n      // update with current values\r\n      point.x = this.x\r\n      point.y = this.y\r\n\r\n      return point\r\n    }\r\n    // transform point with matrix\r\n  , transform: function(matrix) {\r\n      return new SVG.Point(this.native().matrixTransform(matrix.native()))\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n\r\n  // Get point\r\n  point: function(x, y) {\r\n    return new SVG.Point(x,y).transform(this.screenCTM().inverse());\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Element, {\r\n  // Set svg element attribute\r\n  attr: function(a, v, n) {\r\n    // act as full getter\r\n    if (a == null) {\r\n      // get an object of attributes\r\n      a = {}\r\n      v = this.node.attributes\r\n      for (n = v.length - 1; n >= 0; n--)\r\n        a[v[n].nodeName] = SVG.regex.isNumber.test(v[n].nodeValue) ? parseFloat(v[n].nodeValue) : v[n].nodeValue\r\n\r\n      return a\r\n\r\n    } else if (typeof a == 'object') {\r\n      // apply every attribute individually if an object is passed\r\n      for (v in a) this.attr(v, a[v])\r\n\r\n    } else if (v === null) {\r\n        // remove value\r\n        this.node.removeAttribute(a)\r\n\r\n    } else if (v == null) {\r\n      // act as a getter if the first and only argument is not an object\r\n      v = this.node.getAttribute(a)\r\n      return v == null ?\r\n        SVG.defaults.attrs[a] :\r\n      SVG.regex.isNumber.test(v) ?\r\n        parseFloat(v) : v\r\n\r\n    } else {\r\n      // BUG FIX: some browsers will render a stroke if a color is given even though stroke width is 0\r\n      if (a == 'stroke-width')\r\n        this.attr('stroke', parseFloat(v) > 0 ? this._stroke : null)\r\n      else if (a == 'stroke')\r\n        this._stroke = v\r\n\r\n      // convert image fill and stroke to patterns\r\n      if (a == 'fill' || a == 'stroke') {\r\n        if (SVG.regex.isImage.test(v))\r\n          v = this.doc().defs().image(v, 0, 0)\r\n\r\n        if (v instanceof SVG.Image)\r\n          v = this.doc().defs().pattern(0, 0, function() {\r\n            this.add(v)\r\n          })\r\n      }\r\n\r\n      // ensure correct numeric values (also accepts NaN and Infinity)\r\n      if (typeof v === 'number')\r\n        v = new SVG.Number(v)\r\n\r\n      // ensure full hex color\r\n      else if (SVG.Color.isColor(v))\r\n        v = new SVG.Color(v)\r\n\r\n      // parse array values\r\n      else if (Array.isArray(v))\r\n        v = new SVG.Array(v)\r\n\r\n      // store parametric transformation values locally\r\n      else if (v instanceof SVG.Matrix && v.param)\r\n        this.param = v.param\r\n\r\n      // if the passed attribute is leading...\r\n      if (a == 'leading') {\r\n        // ... call the leading method instead\r\n        if (this.leading)\r\n          this.leading(v)\r\n      } else {\r\n        // set given attribute on node\r\n        typeof n === 'string' ?\r\n          this.node.setAttributeNS(n, a, v.toString()) :\r\n          this.node.setAttribute(a, v.toString())\r\n      }\r\n\r\n      // rebuild if required\r\n      if (this.rebuild && (a == 'font-size' || a == 'x'))\r\n        this.rebuild(a, v)\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.extend(SVG.Element, {\r\n  // Add transformations\r\n  transform: function(o, relative) {\r\n    // get target in case of the fx module, otherwise reference this\r\n    var target = this\r\n      , matrix\r\n\r\n    // act as a getter\r\n    if (typeof o !== 'object') {\r\n      // get current matrix\r\n      matrix = new SVG.Matrix(target).extract()\r\n\r\n      return typeof o === 'string' ? matrix[o] : matrix\r\n    }\r\n\r\n    // get current matrix\r\n    matrix = new SVG.Matrix(target)\r\n\r\n    // ensure relative flag\r\n    relative = !!relative || !!o.relative\r\n\r\n    // act on matrix\r\n    if (o.a != null) {\r\n      matrix = relative ?\r\n        // relative\r\n        matrix.multiply(new SVG.Matrix(o)) :\r\n        // absolute\r\n        new SVG.Matrix(o)\r\n\r\n    // act on rotation\r\n    } else if (o.rotation != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // apply transformation\r\n      matrix = relative ?\r\n        // relative\r\n        matrix.rotate(o.rotation, o.cx, o.cy) :\r\n        // absolute\r\n        matrix.rotate(o.rotation - matrix.extract().rotation, o.cx, o.cy)\r\n\r\n    // act on scale\r\n    } else if (o.scale != null || o.scaleX != null || o.scaleY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure scale values on both axes\r\n      o.scaleX = o.scale != null ? o.scale : o.scaleX != null ? o.scaleX : 1\r\n      o.scaleY = o.scale != null ? o.scale : o.scaleY != null ? o.scaleY : 1\r\n\r\n      if (!relative) {\r\n        // absolute; multiply inversed values\r\n        var e = matrix.extract()\r\n        o.scaleX = o.scaleX * 1 / e.scaleX\r\n        o.scaleY = o.scaleY * 1 / e.scaleY\r\n      }\r\n\r\n      matrix = matrix.scale(o.scaleX, o.scaleY, o.cx, o.cy)\r\n\r\n    // act on skew\r\n    } else if (o.skewX != null || o.skewY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure skew values on both axes\r\n      o.skewX = o.skewX != null ? o.skewX : 0\r\n      o.skewY = o.skewY != null ? o.skewY : 0\r\n\r\n      if (!relative) {\r\n        // absolute; reset skew values\r\n        var e = matrix.extract()\r\n        matrix = matrix.multiply(new SVG.Matrix().skew(e.skewX, e.skewY, o.cx, o.cy).inverse())\r\n      }\r\n\r\n      matrix = matrix.skew(o.skewX, o.skewY, o.cx, o.cy)\r\n\r\n    // act on flip\r\n    } else if (o.flip) {\r\n      matrix = matrix.flip(\r\n        o.flip\r\n      , o.offset == null ? target.bbox()['c' + o.flip] : o.offset\r\n      )\r\n\r\n    // act on translate\r\n    } else if (o.x != null || o.y != null) {\r\n      if (relative) {\r\n        // relative\r\n        matrix = matrix.translate(o.x, o.y)\r\n      } else {\r\n        // absolute\r\n        if (o.x != null) matrix.e = o.x\r\n        if (o.y != null) matrix.f = o.y\r\n      }\r\n    }\r\n\r\n    return this.attr('transform', matrix)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.FX, {\r\n  transform: function(o, relative) {\r\n    // get target in case of the fx module, otherwise reference this\r\n    var target = this.target()\r\n      , matrix\r\n\r\n    // act as a getter\r\n    if (typeof o !== 'object') {\r\n      // get current matrix\r\n      matrix = new SVG.Matrix(target).extract()\r\n\r\n      return typeof o === 'string' ? matrix[o] : matrix\r\n    }\r\n\r\n    // ensure relative flag\r\n    relative = !!relative || !!o.relative\r\n\r\n    // act on matrix\r\n    if (o.a != null) {\r\n      matrix = new SVG.Matrix(o)\r\n\r\n    // act on rotation\r\n    } else if (o.rotation != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // apply transformation\r\n      matrix = new SVG.Rotate(o.rotation, o.cx, o.cy)\r\n\r\n    // act on scale\r\n    } else if (o.scale != null || o.scaleX != null || o.scaleY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure scale values on both axes\r\n      o.scaleX = o.scale != null ? o.scale : o.scaleX != null ? o.scaleX : 1\r\n      o.scaleY = o.scale != null ? o.scale : o.scaleY != null ? o.scaleY : 1\r\n\r\n      matrix = new SVG.Scale(o.scaleX, o.scaleY, o.cx, o.cy)\r\n\r\n    // act on skew\r\n    } else if (o.skewX != null || o.skewY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure skew values on both axes\r\n      o.skewX = o.skewX != null ? o.skewX : 0\r\n      o.skewY = o.skewY != null ? o.skewY : 0\r\n\r\n      matrix = new SVG.Skew(o.skewX, o.skewY, o.cx, o.cy)\r\n\r\n    // act on flip\r\n    } else if (o.flip) {\r\n      matrix = new SVG.Matrix().morph(new SVG.Matrix().flip(\r\n        o.flip\r\n      , o.offset == null ? target.bbox()['c' + o.flip] : o.offset\r\n      ))\r\n\r\n    // act on translate\r\n    } else if (o.x != null || o.y != null) {\r\n      matrix = new SVG.Translate(o.x, o.y)\r\n    }\r\n\r\n    if(!matrix) return this\r\n\r\n    matrix.relative = relative\r\n\r\n    this.last().transforms.push(matrix)\r\n\r\n    setTimeout(function(){this.start()}.bind(this), 0)\r\n\r\n    return this\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Reset all transformations\r\n  untransform: function() {\r\n    return this.attr('transform', null)\r\n  },\r\n  // merge the whole transformation chain into one matrix and returns it\r\n  matrixify: function() {\r\n\r\n    var matrix = (this.attr('transform') || '')\r\n      // split transformations\r\n      .split(/\\)\\s*/).slice(0,-1).map(function(str){\r\n        // generate key => value pairs\r\n        var kv = str.trim().split('(')\r\n        return [kv[0], kv[1].split(SVG.regex.matrixElements).map(function(str){ return parseFloat(str) })]\r\n      })\r\n      // calculate every transformation into one matrix\r\n      .reduce(function(matrix, transform){\r\n\r\n        if(transform[0] == 'matrix') return matrix.multiply(arrayToMatrix(transform[1]))\r\n        return matrix[transform[0]].apply(matrix, transform[1])\r\n\r\n      }, new SVG.Matrix())\r\n\r\n    return matrix\r\n  },\r\n  // add an element to another parent without changing the visual representation on the screen\r\n  toParent: function(parent) {\r\n    if(this == parent) return this\r\n    var ctm = this.screenCTM()\r\n    var temp = parent.rect(1,1)\r\n    var pCtm = temp.screenCTM().inverse()\r\n    temp.remove()\r\n\r\n    this.addTo(parent).untransform().transform(pCtm.multiply(ctm))\r\n\r\n    return this\r\n  },\r\n  // same as above with parent equals root-svg\r\n  toDoc: function() {\r\n    return this.toParent(this.doc())\r\n  }\r\n\r\n})\r\n\r\nSVG.Transformation = SVG.invent({\r\n\r\n  create: function(source, inversed){\r\n\r\n    if(arguments.length > 1 && typeof inversed != 'boolean'){\r\n      return this.create([].slice.call(arguments))\r\n    }\r\n\r\n    if(typeof source == 'object'){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        this[this.arguments[i]] = source[this.arguments[i]]\r\n      }\r\n    }\r\n\r\n    if(Array.isArray(source)){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        this[this.arguments[i]] = source[i]\r\n      }\r\n    }\r\n\r\n    this.inversed = false\r\n\r\n    if(inversed === true){\r\n      this.inversed = true\r\n    }\r\n\r\n  }\r\n\r\n, extend: {\r\n\r\n    at: function(pos){\r\n\r\n      var params = []\r\n\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        params.push(this[this.arguments[i]])\r\n      }\r\n\r\n      var m = this._undo || new SVG.Matrix()\r\n\r\n      m = new SVG.Matrix().morph(SVG.Matrix.prototype[this.method].apply(m, params)).at(pos)\r\n\r\n      return this.inversed ? m.inverse() : m\r\n\r\n    }\r\n\r\n  , undo: function(o){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        o[this.arguments[i]] = typeof this[this.arguments[i]] == 'undefined' ? 0 : o[this.arguments[i]]\r\n      }\r\n\r\n      this._undo = new SVG[capitalize(this.method)](o, true).at(1)\r\n\r\n      return this\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\nSVG.Translate = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    if(typeof source == 'object') this.constructor.call(this, source, inversed)\r\n    else this.constructor.call(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['transformedX', 'transformedY']\r\n  , method: 'translate'\r\n  }\r\n\r\n})\r\n\r\nSVG.Rotate = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    if(typeof source == 'object') this.constructor.call(this, source, inversed)\r\n    else this.constructor.call(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['rotation', 'cx', 'cy']\r\n  , method: 'rotate'\r\n  , at: function(pos){\r\n      var m = new SVG.Matrix().rotate(new SVG.Number().morph(this.rotation - (this._undo ? this._undo.rotation : 0)).at(pos), this.cx, this.cy)\r\n      return this.inversed ? m.inverse() : m\r\n    }\r\n  , undo: function(o){\r\n      this._undo = o\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.Scale = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    if(typeof source == 'object') this.constructor.call(this, source, inversed)\r\n    else this.constructor.call(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['scaleX', 'scaleY', 'cx', 'cy']\r\n  , method: 'scale'\r\n  }\r\n\r\n})\r\n\r\nSVG.Skew = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    if(typeof source == 'object') this.constructor.call(this, source, inversed)\r\n    else this.constructor.call(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['skewX', 'skewY', 'cx', 'cy']\r\n  , method: 'skew'\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Element, {\r\n  // Dynamic style generator\r\n  style: function(s, v) {\r\n    if (arguments.length == 0) {\r\n      // get full style\r\n      return this.node.style.cssText || ''\r\n\r\n    } else if (arguments.length < 2) {\r\n      // apply every style individually if an object is passed\r\n      if (typeof s == 'object') {\r\n        for (v in s) this.style(v, s[v])\r\n\r\n      } else if (SVG.regex.isCss.test(s)) {\r\n        // parse css string\r\n        s = s.split(';')\r\n\r\n        // apply every definition individually\r\n        for (var i = 0; i < s.length; i++) {\r\n          v = s[i].split(':')\r\n          this.style(v[0].replace(/\\s+/g, ''), v[1])\r\n        }\r\n      } else {\r\n        // act as a getter if the first and only argument is not an object\r\n        return this.node.style[camelCase(s)]\r\n      }\r\n\r\n    } else {\r\n      this.node.style[camelCase(s)] = v === null || SVG.regex.isBlank.test(v) ? '' : v\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.Parent = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Returns all child elements\r\n    children: function() {\r\n      return SVG.utils.map(SVG.utils.filterSVGElements(this.node.childNodes), function(node) {\r\n        return SVG.adopt(node)\r\n      })\r\n    }\r\n    // Add given element at a position\r\n  , add: function(element, i) {\r\n      if (i == null)\r\n        this.node.appendChild(element.node)\r\n      else if (element.node != this.node.childNodes[i])\r\n        this.node.insertBefore(element.node, this.node.childNodes[i])\r\n\r\n      return this\r\n    }\r\n    // Basically does the same as `add()` but returns the added element instead\r\n  , put: function(element, i) {\r\n      this.add(element, i)\r\n      return element\r\n    }\r\n    // Checks if the given element is a child\r\n  , has: function(element) {\r\n      return this.index(element) >= 0\r\n    }\r\n    // Gets index of given element\r\n  , index: function(element) {\r\n      return [].slice.call(this.node.childNodes).indexOf(element.node)\r\n    }\r\n    // Get a element at the given index\r\n  , get: function(i) {\r\n      return SVG.adopt(this.node.childNodes[i])\r\n    }\r\n    // Get first child\r\n  , first: function() {\r\n      return this.get(0)\r\n    }\r\n    // Get the last child\r\n  , last: function() {\r\n      return this.get(this.node.childNodes.length - 1)\r\n    }\r\n    // Iterates over all children and invokes a given block\r\n  , each: function(block, deep) {\r\n      var i, il\r\n        , children = this.children()\r\n\r\n      for (i = 0, il = children.length; i < il; i++) {\r\n        if (children[i] instanceof SVG.Element)\r\n          block.apply(children[i], [i, children])\r\n\r\n        if (deep && (children[i] instanceof SVG.Container))\r\n          children[i].each(block, deep)\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Remove a given child\r\n  , removeElement: function(element) {\r\n      this.node.removeChild(element.node)\r\n\r\n      return this\r\n    }\r\n    // Remove all elements in this container\r\n  , clear: function() {\r\n      // remove children\r\n      while(this.node.hasChildNodes())\r\n        this.node.removeChild(this.node.lastChild)\r\n\r\n      // remove defs reference\r\n      delete this._defs\r\n\r\n      return this\r\n    }\r\n  , // Get defs\r\n    defs: function() {\r\n      return this.doc().defs()\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Parent, {\r\n\r\n  ungroup: function(parent, depth) {\r\n    if(depth === 0 || this instanceof SVG.Defs) return this\r\n\r\n    parent = parent || (this instanceof SVG.Doc ? this : this.parent(SVG.Parent))\r\n    depth = depth || Infinity\r\n\r\n    this.each(function(){\r\n      if(this instanceof SVG.Defs) return this\r\n      if(this instanceof SVG.Parent) return this.ungroup(parent, depth-1)\r\n      return this.toParent(parent)\r\n    })\r\n\r\n    this.node.firstChild || this.remove()\r\n\r\n    return this\r\n  },\r\n\r\n  flatten: function(parent, depth) {\r\n    return this.ungroup(parent, depth)\r\n  }\r\n\r\n})\nSVG.Container = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Parent\r\n\r\n})\n\r\nSVG.ViewBox = SVG.invent({\r\n\r\n  create: function(source) {\r\n    var i, base = [0, 0, 0, 0]\r\n\r\n    var x, y, width, height, box, view, we, he\r\n      , wm   = 1 // width multiplier\r\n      , hm   = 1 // height multiplier\r\n      , reg  = /[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:e[+-]?\\d+)?/gi\r\n\r\n    if(source instanceof SVG.Element){\r\n\r\n      we = source\r\n      he = source\r\n      view = (source.attr('viewBox') || '').match(reg)\r\n      box = source.bbox\r\n\r\n      // get dimensions of current node\r\n      width  = new SVG.Number(source.width())\r\n      height = new SVG.Number(source.height())\r\n\r\n      // find nearest non-percentual dimensions\r\n      while (width.unit == '%') {\r\n        wm *= width.value\r\n        width = new SVG.Number(we instanceof SVG.Doc ? we.parent().offsetWidth : we.parent().width())\r\n        we = we.parent()\r\n      }\r\n      while (height.unit == '%') {\r\n        hm *= height.value\r\n        height = new SVG.Number(he instanceof SVG.Doc ? he.parent().offsetHeight : he.parent().height())\r\n        he = he.parent()\r\n      }\r\n\r\n      // ensure defaults\r\n      this.x      = 0\r\n      this.y      = 0\r\n      this.width  = width  * wm\r\n      this.height = height * hm\r\n      this.zoom   = 1\r\n\r\n      if (view) {\r\n        // get width and height from viewbox\r\n        x      = parseFloat(view[0])\r\n        y      = parseFloat(view[1])\r\n        width  = parseFloat(view[2])\r\n        height = parseFloat(view[3])\r\n\r\n        // calculate zoom accoring to viewbox\r\n        this.zoom = ((this.width / this.height) > (width / height)) ?\r\n          this.height / height :\r\n          this.width  / width\r\n\r\n        // calculate real pixel dimensions on parent SVG.Doc element\r\n        this.x      = x\r\n        this.y      = y\r\n        this.width  = width\r\n        this.height = height\r\n\r\n      }\r\n\r\n    }else{\r\n\r\n      // ensure source as object\r\n      source = typeof source === 'string' ?\r\n        source.match(reg).map(function(el){ return parseFloat(el) }) :\r\n      Array.isArray(source) ?\r\n        source :\r\n      typeof source == 'object' ?\r\n        [source.x, source.y, source.width, source.height] :\r\n      arguments.length == 4 ?\r\n        [].slice.call(arguments) :\r\n        base\r\n\r\n      this.x = source[0]\r\n      this.y = source[1]\r\n      this.width = source[2]\r\n      this.height = source[3]\r\n    }\r\n\r\n\r\n  }\r\n\r\n, extend: {\r\n\r\n    toString: function() {\r\n      return this.x + ' ' + this.y + ' ' + this.width + ' ' + this.height\r\n    }\r\n  , morph: function(v){\r\n\r\n      var v = arguments.length == 1 ?\r\n        [v.x, v.y, v.width, v.height] :\r\n        [].slice.call(arguments)\r\n\r\n      this.destination = new SVG.ViewBox(v)\r\n\r\n      return this\r\n\r\n    }\r\n\r\n  , at: function(pos) {\r\n\r\n    if(!this.destination) return this\r\n\r\n    return new SVG.ViewBox([\r\n        this.x + (this.destination.x - this.x) * pos\r\n      , this.y + (this.destination.y - this.y) * pos\r\n      , this.width + (this.destination.width - this.width) * pos\r\n      , this.height + (this.destination.height - this.height) * pos\r\n    ])\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Define parent\r\n, parent: SVG.Container\r\n\r\n  // Add parent method\r\n, construct: {\r\n\r\n    // get/set viewbox\r\n    viewbox: function(v) {\r\n      if (arguments.length == 0)\r\n        // act as a getter if there are no arguments\r\n        return new SVG.ViewBox(this)\r\n\r\n      // otherwise act as a setter\r\n      v = arguments.length == 1 ?\r\n        [v.x, v.y, v.width, v.height] :\r\n        [].slice.call(arguments)\r\n\r\n      return this.attr('viewBox', v)\r\n    }\r\n\r\n  }\r\n\r\n})\n// Add events to elements\r\n;[  'click'\r\n  , 'dblclick'\r\n  , 'mousedown'\r\n  , 'mouseup'\r\n  , 'mouseover'\r\n  , 'mouseout'\r\n  , 'mousemove'\r\n  // , 'mouseenter' -> not supported by IE\r\n  // , 'mouseleave' -> not supported by IE\r\n  , 'touchstart'\r\n  , 'touchmove'\r\n  , 'touchleave'\r\n  , 'touchend'\r\n  , 'touchcancel' ].forEach(function(event) {\r\n\r\n  // add event to SVG.Element\r\n  SVG.Element.prototype[event] = function(f) {\r\n    var self = this\r\n\r\n    // bind event to element rather than element node\r\n    this.node['on' + event] = typeof f == 'function' ?\r\n      function() { return f.apply(self, arguments) } : null\r\n\r\n    return this\r\n  }\r\n\r\n})\r\n\r\n// Initialize listeners stack\r\nSVG.listeners = []\r\nSVG.handlerMap = []\r\nSVG.listenerId = 0\r\n\r\n// Add event binder in the SVG namespace\r\nSVG.on = function(node, event, listener, binding) {\r\n  // create listener, get object-index\r\n  var l     = listener.bind(binding || node.instance || node)\r\n    , index = (SVG.handlerMap.indexOf(node) + 1 || SVG.handlerMap.push(node)) - 1\r\n    , ev    = event.split('.')[0]\r\n    , ns    = event.split('.')[1] || '*'\r\n\r\n\r\n  // ensure valid object\r\n  SVG.listeners[index]         = SVG.listeners[index]         || {}\r\n  SVG.listeners[index][ev]     = SVG.listeners[index][ev]     || {}\r\n  SVG.listeners[index][ev][ns] = SVG.listeners[index][ev][ns] || {}\r\n\r\n  if(!listener._svgjsListenerId)\r\n    listener._svgjsListenerId = ++SVG.listenerId\r\n\r\n  // reference listener\r\n  SVG.listeners[index][ev][ns][listener._svgjsListenerId] = l\r\n\r\n  // add listener\r\n  node.addEventListener(ev, l, false)\r\n}\r\n\r\n// Add event unbinder in the SVG namespace\r\nSVG.off = function(node, event, listener) {\r\n  var index = SVG.handlerMap.indexOf(node)\r\n    , ev    = event && event.split('.')[0]\r\n    , ns    = event && event.split('.')[1]\r\n\r\n  if(index == -1) return\r\n\r\n  if (listener) {\r\n    if(typeof listener == 'function') listener = listener._svgjsListenerId\r\n    if(!listener) return\r\n\r\n    // remove listener reference\r\n    if (SVG.listeners[index][ev] && SVG.listeners[index][ev][ns || '*']) {\r\n      // remove listener\r\n      node.removeEventListener(ev, SVG.listeners[index][ev][ns || '*'][listener], false)\r\n\r\n      delete SVG.listeners[index][ev][ns || '*'][listener]\r\n    }\r\n\r\n  } else if (ns && ev) {\r\n    // remove all listeners for a namespaced event\r\n    if (SVG.listeners[index][ev] && SVG.listeners[index][ev][ns]) {\r\n      for (listener in SVG.listeners[index][ev][ns])\r\n        SVG.off(node, [ev, ns].join('.'), listener)\r\n\r\n      delete SVG.listeners[index][ev][ns]\r\n    }\r\n\r\n  } else if (ns){\r\n    // remove all listeners for a specific namespace\r\n    for(event in SVG.listeners[index]){\r\n        for(namespace in SVG.listeners[index][event]){\r\n            if(ns === namespace){\r\n                SVG.off(node, [event, ns].join('.'))\r\n            }\r\n        }\r\n    }\r\n\r\n  } else if (ev) {\r\n    // remove all listeners for the event\r\n    if (SVG.listeners[index][ev]) {\r\n      for (namespace in SVG.listeners[index][ev])\r\n        SVG.off(node, [ev, namespace].join('.'))\r\n\r\n      delete SVG.listeners[index][ev]\r\n    }\r\n\r\n  } else {\r\n    // remove all listeners on a given node\r\n    for (event in SVG.listeners[index])\r\n      SVG.off(node, event)\r\n\r\n    delete SVG.listeners[index]\r\n\r\n  }\r\n}\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Bind given event to listener\r\n  on: function(event, listener, binding) {\r\n    SVG.on(this.node, event, listener, binding)\r\n\r\n    return this\r\n  }\r\n  // Unbind event from listener\r\n, off: function(event, listener) {\r\n    SVG.off(this.node, event, listener)\r\n\r\n    return this\r\n  }\r\n  // Fire given event\r\n, fire: function(event, data) {\r\n\r\n    // Dispatch event\r\n    if(event instanceof Event){\r\n        this.node.dispatchEvent(event)\r\n    }else{\r\n        this.node.dispatchEvent(new CustomEvent(event, {detail:data}))\r\n    }\r\n\r\n    return this\r\n  }\r\n})\n\r\nSVG.Defs = SVG.invent({\r\n  // Initialize node\r\n  create: 'defs'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n})\nSVG.G = SVG.invent({\r\n  // Initialize node\r\n  create: 'g'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return x == null ? this.transform('x') : this.transform({ x: x - this.x() }, true)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.transform('y') : this.transform({ y: y - this.y() }, true)\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.gbox().cx : this.x(x - this.gbox().width / 2)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.gbox().cy : this.y(y - this.gbox().height / 2)\r\n    }\r\n  , gbox: function() {\r\n\r\n      var bbox  = this.bbox()\r\n        , trans = this.transform()\r\n\r\n      bbox.x  += trans.x\r\n      bbox.x2 += trans.x\r\n      bbox.cx += trans.x\r\n\r\n      bbox.y  += trans.y\r\n      bbox.y2 += trans.y\r\n      bbox.cy += trans.y\r\n\r\n      return bbox\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a group element\r\n    group: function() {\r\n      return this.put(new SVG.G)\r\n    }\r\n  }\r\n})\r\n\n// ### This module adds backward / forward functionality to elements.\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Get all siblings, including myself\r\n  siblings: function() {\r\n    return this.parent().children()\r\n  }\r\n  // Get the curent position siblings\r\n, position: function() {\r\n    return this.parent().index(this)\r\n  }\r\n  // Get the next element (will return null if there is none)\r\n, next: function() {\r\n    return this.siblings()[this.position() + 1]\r\n  }\r\n  // Get the next element (will return null if there is none)\r\n, previous: function() {\r\n    return this.siblings()[this.position() - 1]\r\n  }\r\n  // Send given element one step forward\r\n, forward: function() {\r\n    var i = this.position() + 1\r\n      , p = this.parent()\r\n\r\n    // move node one step forward\r\n    p.removeElement(this).add(this, i)\r\n\r\n    // make sure defs node is always at the top\r\n    if (p instanceof SVG.Doc)\r\n      p.node.appendChild(p.defs().node)\r\n\r\n    return this\r\n  }\r\n  // Send given element one step backward\r\n, backward: function() {\r\n    var i = this.position()\r\n\r\n    if (i > 0)\r\n      this.parent().removeElement(this).add(this, i - 1)\r\n\r\n    return this\r\n  }\r\n  // Send given element all the way to the front\r\n, front: function() {\r\n    var p = this.parent()\r\n\r\n    // Move node forward\r\n    p.node.appendChild(this.node)\r\n\r\n    // Make sure defs node is always at the top\r\n    if (p instanceof SVG.Doc)\r\n      p.node.appendChild(p.defs().node)\r\n\r\n    return this\r\n  }\r\n  // Send given element all the way to the back\r\n, back: function() {\r\n    if (this.position() > 0)\r\n      this.parent().removeElement(this).add(this, 0)\r\n\r\n    return this\r\n  }\r\n  // Inserts a given element before the targeted element\r\n, before: function(element) {\r\n    element.remove()\r\n\r\n    var i = this.position()\r\n\r\n    this.parent().add(element, i)\r\n\r\n    return this\r\n  }\r\n  // Insters a given element after the targeted element\r\n, after: function(element) {\r\n    element.remove()\r\n\r\n    var i = this.position()\r\n\r\n    this.parent().add(element, i + 1)\r\n\r\n    return this\r\n  }\r\n\r\n})\nSVG.Mask = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('mask'))\r\n\r\n    // keep references to masked elements\r\n    this.targets = []\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Unmask all masked elements and remove itself\r\n    remove: function() {\r\n      // unmask all targets\r\n      for (var i = this.targets.length - 1; i >= 0; i--)\r\n        if (this.targets[i])\r\n          this.targets[i].unmask()\r\n      this.targets = []\r\n\r\n      // remove mask from parent\r\n      this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create masking element\r\n    mask: function() {\r\n      return this.defs().put(new SVG.Mask)\r\n    }\r\n  }\r\n})\r\n\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Distribute mask to svg element\r\n  maskWith: function(element) {\r\n    // use given mask or create a new one\r\n    this.masker = element instanceof SVG.Mask ? element : this.parent().mask().add(element)\r\n\r\n    // store reverence on self in mask\r\n    this.masker.targets.push(this)\r\n\r\n    // apply mask\r\n    return this.attr('mask', 'url(\"#' + this.masker.attr('id') + '\")')\r\n  }\r\n  // Unmask element\r\n, unmask: function() {\r\n    delete this.masker\r\n    return this.attr('mask', null)\r\n  }\r\n\r\n})\r\n\nSVG.ClipPath = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('clipPath'))\r\n\r\n    // keep references to clipped elements\r\n    this.targets = []\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Unclip all clipped elements and remove itself\r\n    remove: function() {\r\n      // unclip all targets\r\n      for (var i = this.targets.length - 1; i >= 0; i--)\r\n        if (this.targets[i])\r\n          this.targets[i].unclip()\r\n      this.targets = []\r\n\r\n      // remove clipPath from parent\r\n      this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create clipping element\r\n    clip: function() {\r\n      return this.defs().put(new SVG.ClipPath)\r\n    }\r\n  }\r\n})\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Distribute clipPath to svg element\r\n  clipWith: function(element) {\r\n    // use given clip or create a new one\r\n    this.clipper = element instanceof SVG.ClipPath ? element : this.parent().clip().add(element)\r\n\r\n    // store reverence on self in mask\r\n    this.clipper.targets.push(this)\r\n\r\n    // apply mask\r\n    return this.attr('clip-path', 'url(\"#' + this.clipper.attr('id') + '\")')\r\n  }\r\n  // Unclip element\r\n, unclip: function() {\r\n    delete this.clipper\r\n    return this.attr('clip-path', null)\r\n  }\r\n\r\n})\nSVG.Gradient = SVG.invent({\r\n  // Initialize node\r\n  create: function(type) {\r\n    this.constructor.call(this, SVG.create(type + 'Gradient'))\r\n\r\n    // store type\r\n    this.type = type\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add a color stop\r\n    at: function(offset, color, opacity) {\r\n      return this.put(new SVG.Stop).update(offset, color, opacity)\r\n    }\r\n    // Update gradient\r\n  , update: function(block) {\r\n      // remove all stops\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Return the fill id\r\n  , fill: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n    // Alias string convertion to fill\r\n  , toString: function() {\r\n      return this.fill()\r\n    }\r\n    // custom attr to handle transform\r\n  , attr: function(a, b, c) {\r\n      if(a == 'transform') a = 'gradientTransform'\r\n      return SVG.Container.prototype.attr.call(this, a, b, c)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create gradient element in defs\r\n    gradient: function(type, block) {\r\n      return this.defs().gradient(type, block)\r\n    }\r\n  }\r\n})\r\n\r\n// Add animatable methods to both gradient and fx module\r\nSVG.extend(SVG.Gradient, SVG.FX, {\r\n  // From position\r\n  from: function(x, y) {\r\n    return (this._target || this).type == 'radial' ?\r\n      this.attr({ fx: new SVG.Number(x), fy: new SVG.Number(y) }) :\r\n      this.attr({ x1: new SVG.Number(x), y1: new SVG.Number(y) })\r\n  }\r\n  // To position\r\n, to: function(x, y) {\r\n    return (this._target || this).type == 'radial' ?\r\n      this.attr({ cx: new SVG.Number(x), cy: new SVG.Number(y) }) :\r\n      this.attr({ x2: new SVG.Number(x), y2: new SVG.Number(y) })\r\n  }\r\n})\r\n\r\n// Base gradient generation\r\nSVG.extend(SVG.Defs, {\r\n  // define gradient\r\n  gradient: function(type, block) {\r\n    return this.put(new SVG.Gradient(type)).update(block)\r\n  }\r\n\r\n})\r\n\r\nSVG.Stop = SVG.invent({\r\n  // Initialize node\r\n  create: 'stop'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // add color stops\r\n    update: function(o) {\r\n      if (typeof o == 'number' || o instanceof SVG.Number) {\r\n        o = {\r\n          offset:  arguments[0]\r\n        , color:   arguments[1]\r\n        , opacity: arguments[2]\r\n        }\r\n      }\r\n\r\n      // set attributes\r\n      if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n      if (o.color   != null) this.attr('stop-color', o.color)\r\n      if (o.offset  != null) this.attr('offset', new SVG.Number(o.offset))\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.Pattern = SVG.invent({\r\n  // Initialize node\r\n  create: 'pattern'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Return the fill id\r\n    fill: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n    // Update pattern by rebuilding\r\n  , update: function(block) {\r\n      // remove content\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Alias string convertion to fill\r\n  , toString: function() {\r\n      return this.fill()\r\n    }\r\n    // custom attr to handle transform\r\n  , attr: function(a, b, c) {\r\n      if(a == 'transform') a = 'patternTransform'\r\n      return SVG.Container.prototype.attr.call(this, a, b, c)\r\n    }\r\n\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create pattern element in defs\r\n    pattern: function(width, height, block) {\r\n      return this.defs().pattern(width, height, block)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Defs, {\r\n  // Define gradient\r\n  pattern: function(width, height, block) {\r\n    return this.put(new SVG.Pattern).update(block).attr({\r\n      x:            0\r\n    , y:            0\r\n    , width:        width\r\n    , height:       height\r\n    , patternUnits: 'userSpaceOnUse'\r\n    })\r\n  }\r\n\r\n})\nSVG.Doc = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    if (element) {\r\n      // ensure the presence of a dom element\r\n      element = typeof element == 'string' ?\r\n        document.getElementById(element) :\r\n        element\r\n\r\n      // If the target is an svg element, use that element as the main wrapper.\r\n      // This allows svg.js to work with svg documents as well.\r\n      if (element.nodeName == 'svg') {\r\n        this.constructor.call(this, element)\r\n      } else {\r\n        this.constructor.call(this, SVG.create('svg'))\r\n        element.appendChild(this.node)\r\n        this.size('100%', '100%')\r\n      }\r\n\r\n      // set svg element attributes and ensure defs node\r\n      this.namespace().defs()\r\n    }\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add namespaces\r\n    namespace: function() {\r\n      return this\r\n        .attr({ xmlns: SVG.ns, version: '1.1' })\r\n        .attr('xmlns:xlink', SVG.xlink, SVG.xmlns)\r\n        .attr('xmlns:svgjs', SVG.svgjs, SVG.xmlns)\r\n    }\r\n    // Creates and returns defs element\r\n  , defs: function() {\r\n      if (!this._defs) {\r\n        var defs\r\n\r\n        // Find or create a defs element in this instance\r\n        if (defs = this.node.getElementsByTagName('defs')[0])\r\n          this._defs = SVG.adopt(defs)\r\n        else\r\n          this._defs = new SVG.Defs\r\n\r\n        // Make sure the defs node is at the end of the stack\r\n        this.node.appendChild(this._defs.node)\r\n      }\r\n\r\n      return this._defs\r\n    }\r\n    // custom parent method\r\n  , parent: function() {\r\n      return this.node.parentNode.nodeName == '#document' ? null : this.node.parentNode\r\n    }\r\n    // Fix for possible sub-pixel offset. See:\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=608812\r\n  , spof: function(spof) {\r\n      var pos = this.node.getScreenCTM()\r\n\r\n      if (pos)\r\n        this\r\n          .style('left', (-pos.e % 1) + 'px')\r\n          .style('top',  (-pos.f % 1) + 'px')\r\n\r\n      return this\r\n    }\r\n\r\n      // Removes the doc from the DOM\r\n  , remove: function() {\r\n      if(this.parent()) {\r\n        this.parent().removeChild(this.node);\r\n      }\r\n\r\n      return this;\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.Shape = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n})\n\r\nSVG.Bare = SVG.invent({\r\n  // Initialize\r\n  create: function(element, inherit) {\r\n    // construct element\r\n    this.constructor.call(this, SVG.create(element))\r\n\r\n    // inherit custom methods\r\n    if (inherit)\r\n      for (var method in inherit.prototype)\r\n        if (typeof inherit.prototype[method] === 'function')\r\n          this[method] = inherit.prototype[method]\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Insert some plain text\r\n    words: function(text) {\r\n      // remove contents\r\n      while (this.node.hasChildNodes())\r\n        this.node.removeChild(this.node.lastChild)\r\n\r\n      // create text node\r\n      this.node.appendChild(document.createTextNode(text))\r\n\r\n      return this\r\n    }\r\n  }\r\n})\r\n\r\n\r\nSVG.extend(SVG.Parent, {\r\n  // Create an element that is not described by SVG.js\r\n  element: function(element, inherit) {\r\n    return this.put(new SVG.Bare(element, inherit))\r\n  }\r\n  // Add symbol element\r\n, symbol: function() {\r\n    return this.defs().element('symbol', SVG.Container)\r\n  }\r\n\r\n})\nSVG.Use = SVG.invent({\r\n  // Initialize node\r\n  create: 'use'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Use element as a reference\r\n    element: function(element, file) {\r\n      // Set lined element\r\n      return this.attr('href', (file || '') + '#' + element, SVG.xlink)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a use element\r\n    use: function(element, file) {\r\n      return this.put(new SVG.Use).element(element, file)\r\n    }\r\n  }\r\n})\nSVG.Rect = SVG.invent({\r\n  // Initialize node\r\n  create: 'rect'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a rect element\r\n    rect: function(width, height) {\r\n      return this.put(new SVG.Rect()).size(width, height)\r\n    }\r\n  }\r\n})\nSVG.Circle = SVG.invent({\r\n  // Initialize node\r\n  create: 'circle'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create circle element, based on ellipse\r\n    circle: function(size) {\r\n      return this.put(new SVG.Circle).rx(new SVG.Number(size).divide(2)).move(0, 0)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Circle, SVG.FX, {\r\n  // Radius x value\r\n  rx: function(rx) {\r\n    return this.attr('r', rx)\r\n  }\r\n  // Alias radius x value\r\n, ry: function(ry) {\r\n    return this.rx(ry)\r\n  }\r\n})\r\n\r\nSVG.Ellipse = SVG.invent({\r\n  // Initialize node\r\n  create: 'ellipse'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create an ellipse\r\n    ellipse: function(width, height) {\r\n      return this.put(new SVG.Ellipse).size(width, height).move(0, 0)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Ellipse, SVG.Rect, SVG.FX, {\r\n  // Radius x value\r\n  rx: function(rx) {\r\n    return this.attr('rx', rx)\r\n  }\r\n  // Radius y value\r\n, ry: function(ry) {\r\n    return this.attr('ry', ry)\r\n  }\r\n})\r\n\r\n// Add common method\r\nSVG.extend(SVG.Circle, SVG.Ellipse, {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return x == null ? this.cx() - this.rx() : this.cx(x + this.rx())\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.cy() - this.ry() : this.cy(y + this.ry())\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.attr('cx') : this.attr('cx', x)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.attr('cy') : this.attr('cy', y)\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return width == null ? this.rx() * 2 : this.rx(new SVG.Number(width).divide(2))\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return height == null ? this.ry() * 2 : this.ry(new SVG.Number(height).divide(2))\r\n    }\r\n    // Custom size function\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this\r\n        .rx(new SVG.Number(p.width).divide(2))\r\n        .ry(new SVG.Number(p.height).divide(2))\r\n    }\r\n})\nSVG.Line = SVG.invent({\r\n  // Initialize node\r\n  create: 'line'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Get array\r\n    array: function() {\r\n      return new SVG.PointArray([\r\n        [ this.attr('x1'), this.attr('y1') ]\r\n      , [ this.attr('x2'), this.attr('y2') ]\r\n      ])\r\n    }\r\n    // Overwrite native plot() method\r\n  , plot: function(x1, y1, x2, y2) {\r\n      if (typeof y1 !== 'undefined')\r\n        x1 = { x1: x1, y1: y1, x2: x2, y2: y2 }\r\n      else\r\n        x1 = new SVG.PointArray(x1).toLine()\r\n\r\n      return this.attr(x1)\r\n    }\r\n    // Move by left top corner\r\n  , move: function(x, y) {\r\n      return this.attr(this.array().move(x, y).toLine())\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this.attr(this.array().size(p.width, p.height).toLine())\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a line element\r\n    line: function(x1, y1, x2, y2) {\r\n      return this.put(new SVG.Line).plot(x1, y1, x2, y2)\r\n    }\r\n  }\r\n})\r\n\nSVG.Polyline = SVG.invent({\r\n  // Initialize node\r\n  create: 'polyline'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped polyline element\r\n    polyline: function(p) {\r\n      return this.put(new SVG.Polyline).plot(p)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.Polygon = SVG.invent({\r\n  // Initialize node\r\n  create: 'polygon'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped polygon element\r\n    polygon: function(p) {\r\n      return this.put(new SVG.Polygon).plot(p)\r\n    }\r\n  }\r\n})\r\n\r\n// Add polygon-specific functions\r\nSVG.extend(SVG.Polyline, SVG.Polygon, {\r\n  // Get array\r\n  array: function() {\r\n    return this._array || (this._array = new SVG.PointArray(this.attr('points')))\r\n  }\r\n  // Plot new path\r\n, plot: function(p) {\r\n    return this.attr('points', (this._array = new SVG.PointArray(p)))\r\n  }\r\n  // Move by left top corner\r\n, move: function(x, y) {\r\n    return this.attr('points', this.array().move(x, y))\r\n  }\r\n  // Set element size to given width and height\r\n, size: function(width, height) {\r\n    var p = proportionalSize(this, width, height)\r\n\r\n    return this.attr('points', this.array().size(p.width, p.height))\r\n  }\r\n\r\n})\n// unify all point to point elements\r\nSVG.extend(SVG.Line, SVG.Polyline, SVG.Polygon, {\r\n  // Define morphable array\r\n  morphArray:  SVG.PointArray\r\n  // Move by left top corner over x-axis\r\n, x: function(x) {\r\n    return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n  }\r\n  // Move by left top corner over y-axis\r\n, y: function(y) {\r\n    return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n  }\r\n  // Set width of element\r\n, width: function(width) {\r\n    var b = this.bbox()\r\n\r\n    return width == null ? b.width : this.size(width, b.height)\r\n  }\r\n  // Set height of element\r\n, height: function(height) {\r\n    var b = this.bbox()\r\n\r\n    return height == null ? b.height : this.size(b.width, height)\r\n  }\r\n})\nSVG.Path = SVG.invent({\r\n  // Initialize node\r\n  create: 'path'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Define morphable array\r\n    morphArray:  SVG.PathArray\r\n    // Get array\r\n  , array: function() {\r\n      return this._array || (this._array = new SVG.PathArray(this.attr('d')))\r\n    }\r\n    // Plot new poly points\r\n  , plot: function(p) {\r\n      return this.attr('d', (this._array = new SVG.PathArray(p)))\r\n    }\r\n    // Move by left top corner\r\n  , move: function(x, y) {\r\n      return this.attr('d', this.array().move(x, y))\r\n    }\r\n    // Move by left top corner over x-axis\r\n  , x: function(x) {\r\n      return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n    }\r\n    // Move by left top corner over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this.attr('d', this.array().size(p.width, p.height))\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return width == null ? this.bbox().width : this.size(width, this.bbox().height)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return height == null ? this.bbox().height : this.size(this.bbox().width, height)\r\n    }\r\n\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped path element\r\n    path: function(d) {\r\n      return this.put(new SVG.Path).plot(d)\r\n    }\r\n  }\r\n})\nSVG.Image = SVG.invent({\r\n  // Initialize node\r\n  create: 'image'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // (re)load image\r\n    load: function(url) {\r\n      if (!url) return this\r\n\r\n      var self = this\r\n        , img  = document.createElement('img')\r\n\r\n      // preload image\r\n      img.onload = function() {\r\n        var p = self.parent(SVG.Pattern)\r\n\r\n        if(p === null) return\r\n\r\n        // ensure image size\r\n        if (self.width() == 0 && self.height() == 0)\r\n          self.size(img.width, img.height)\r\n\r\n        // ensure pattern size if not set\r\n        if (p && p.width() == 0 && p.height() == 0)\r\n          p.size(self.width(), self.height())\r\n\r\n        // callback\r\n        if (typeof self._loaded === 'function')\r\n          self._loaded.call(self, {\r\n            width:  img.width\r\n          , height: img.height\r\n          , ratio:  img.width / img.height\r\n          , url:    url\r\n          })\r\n      }\r\n\r\n      img.onerror = function(e){\r\n        if (typeof self._error === 'function'){\r\n            self._error.call(self, e)\r\n        }\r\n      }\r\n\r\n      return this.attr('href', (img.src = this.src = url), SVG.xlink)\r\n    }\r\n    // Add loaded callback\r\n  , loaded: function(loaded) {\r\n      this._loaded = loaded\r\n      return this\r\n    }\r\n\r\n  , error: function(error) {\r\n      this._error = error\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // create image element, load image and set its size\r\n    image: function(source, width, height) {\r\n      return this.put(new SVG.Image).load(source).size(width || 0, height || width || 0)\r\n    }\r\n  }\r\n\r\n})\nSVG.Text = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('text'))\r\n\r\n    this.dom.leading = new SVG.Number(1.3)    // store leading value for rebuilding\r\n    this._rebuild = true                      // enable automatic updating of dy values\r\n    this._build   = false                     // disable build mode for adding multiple lines\r\n\r\n    // set default font\r\n    this.attr('font-family', SVG.defaults.attrs['font-family'])\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      // act as getter\r\n      if (x == null)\r\n        return this.attr('x')\r\n\r\n      // move lines as well if no textPath is present\r\n      if (!this.textPath)\r\n        this.lines().each(function() { if (this.dom.newLined) this.x(x) })\r\n\r\n      return this.attr('x', x)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      var oy = this.attr('y')\r\n        , o  = typeof oy === 'number' ? oy - this.bbox().y : 0\r\n\r\n      // act as getter\r\n      if (y == null)\r\n        return typeof oy === 'number' ? oy - o : oy\r\n\r\n      return this.attr('y', typeof y === 'number' ? y + o : y)\r\n    }\r\n    // Move center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.bbox().cx : this.x(x - this.bbox().width / 2)\r\n    }\r\n    // Move center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.bbox().cy : this.y(y - this.bbox().height / 2)\r\n    }\r\n    // Set the text content\r\n  , text: function(text) {\r\n      // act as getter\r\n      if (typeof text === 'undefined'){\r\n        var text = ''\r\n        var children = this.node.childNodes\r\n        for(var i = 0, len = children.length; i < len; ++i){\r\n\r\n          // add newline if its not the first child and newLined is set to true\r\n          if(i != 0 && children[i].nodeType != 3 && SVG.adopt(children[i]).dom.newLined == true){\r\n            text += '\\n'\r\n          }\r\n\r\n          // add content of this node\r\n          text += children[i].textContent\r\n        }\r\n\r\n        return text\r\n      }\r\n\r\n      // remove existing content\r\n      this.clear().build(true)\r\n\r\n      if (typeof text === 'function') {\r\n        // call block\r\n        text.call(this, this)\r\n\r\n      } else {\r\n        // store text and make sure text is not blank\r\n        text = text.split('\\n')\r\n\r\n        // build new lines\r\n        for (var i = 0, il = text.length; i < il; i++)\r\n          this.tspan(text[i]).newLine()\r\n      }\r\n\r\n      // disable build mode and rebuild lines\r\n      return this.build(false).rebuild()\r\n    }\r\n    // Set font size\r\n  , size: function(size) {\r\n      return this.attr('font-size', size).rebuild()\r\n    }\r\n    // Set / get leading\r\n  , leading: function(value) {\r\n      // act as getter\r\n      if (value == null)\r\n        return this.dom.leading\r\n\r\n      // act as setter\r\n      this.dom.leading = new SVG.Number(value)\r\n\r\n      return this.rebuild()\r\n    }\r\n    // Get all the first level lines\r\n  , lines: function() {\r\n      var node = (this.textPath && this.textPath() || this).node\r\n\r\n      // filter tspans and map them to SVG.js instances\r\n      var lines = SVG.utils.map(SVG.utils.filterSVGElements(node.childNodes), function(el){\r\n        return SVG.adopt(el)\r\n      })\r\n\r\n      // return an instance of SVG.set\r\n      return new SVG.Set(lines)\r\n    }\r\n    // Rebuild appearance type\r\n  , rebuild: function(rebuild) {\r\n      // store new rebuild flag if given\r\n      if (typeof rebuild == 'boolean')\r\n        this._rebuild = rebuild\r\n\r\n      // define position of all lines\r\n      if (this._rebuild) {\r\n        var self = this\r\n          , blankLineOffset = 0\r\n          , dy = this.dom.leading * new SVG.Number(this.attr('font-size'))\r\n\r\n        this.lines().each(function() {\r\n          if (this.dom.newLined) {\r\n            if (!this.textPath)\r\n              this.attr('x', self.attr('x'))\r\n\r\n            if(this.text() == '\\n') {\r\n              blankLineOffset += dy\r\n            }else{\r\n              this.attr('dy', dy + blankLineOffset)\r\n              blankLineOffset = 0\r\n            }\r\n          }\r\n        })\r\n\r\n        this.fire('rebuild')\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Enable / disable build mode\r\n  , build: function(build) {\r\n      this._build = !!build\r\n      return this\r\n    }\r\n    // overwrite method from parent to set data properly\r\n  , setData: function(o){\r\n      this.dom = o\r\n      this.dom.leading = new SVG.Number(o.leading || 1.3)\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create text element\r\n    text: function(text) {\r\n      return this.put(new SVG.Text).text(text)\r\n    }\r\n    // Create plain text element\r\n  , plain: function(text) {\r\n      return this.put(new SVG.Text).plain(text)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.Tspan = SVG.invent({\r\n  // Initialize node\r\n  create: 'tspan'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Set text content\r\n    text: function(text) {\r\n      if(text == null) return this.node.textContent + (this.dom.newLined ? '\\n' : '')\r\n\r\n      typeof text === 'function' ? text.call(this, this) : this.plain(text)\r\n\r\n      return this\r\n    }\r\n    // Shortcut dx\r\n  , dx: function(dx) {\r\n      return this.attr('dx', dx)\r\n    }\r\n    // Shortcut dy\r\n  , dy: function(dy) {\r\n      return this.attr('dy', dy)\r\n    }\r\n    // Create new line\r\n  , newLine: function() {\r\n      // fetch text parent\r\n      var t = this.parent(SVG.Text)\r\n\r\n      // mark new line\r\n      this.dom.newLined = true\r\n\r\n      // apply new hyn\r\n      return this.dy(t.dom.leading * t.attr('font-size')).attr('x', t.x())\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Text, SVG.Tspan, {\r\n  // Create plain text node\r\n  plain: function(text) {\r\n    // clear if build mode is disabled\r\n    if (this._build === false)\r\n      this.clear()\r\n\r\n    // create text node\r\n    this.node.appendChild(document.createTextNode(text))\r\n\r\n    return this\r\n  }\r\n  // Create a tspan\r\n, tspan: function(text) {\r\n    var node  = (this.textPath && this.textPath() || this).node\r\n      , tspan = new SVG.Tspan\r\n\r\n    // clear if build mode is disabled\r\n    if (this._build === false)\r\n      this.clear()\r\n\r\n    // add new tspan\r\n    node.appendChild(tspan.node)\r\n\r\n    return tspan.text(text)\r\n  }\r\n  // Clear all lines\r\n, clear: function() {\r\n    var node = (this.textPath && this.textPath() || this).node\r\n\r\n    // remove existing child nodes\r\n    while (node.hasChildNodes())\r\n      node.removeChild(node.lastChild)\r\n\r\n    return this\r\n  }\r\n  // Get length of text element\r\n, length: function() {\r\n    return this.node.getComputedTextLength()\r\n  }\r\n})\r\n\nSVG.TextPath = SVG.invent({\r\n  // Initialize node\r\n  create: 'textPath'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Parent\r\n\r\n  // Define parent class\r\n, parent: SVG.Text\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create path for text to run on\r\n    path: function(d) {\r\n      // create textPath element\r\n      var path  = new SVG.TextPath\r\n        , track = this.doc().defs().path(d)\r\n\r\n      // move lines to textpath\r\n      while (this.node.hasChildNodes())\r\n        path.node.appendChild(this.node.firstChild)\r\n\r\n      // add textPath element as child node\r\n      this.node.appendChild(path.node)\r\n\r\n      // link textPath to path and add content\r\n      path.attr('href', '#' + track, SVG.xlink)\r\n\r\n      return this\r\n    }\r\n    // Plot path if any\r\n  , plot: function(d) {\r\n      var track = this.track()\r\n\r\n      if (track)\r\n        track.plot(d)\r\n\r\n      return this\r\n    }\r\n    // Get the path track element\r\n  , track: function() {\r\n      var path = this.textPath()\r\n\r\n      if (path)\r\n        return path.reference('href')\r\n    }\r\n    // Get the textPath child\r\n  , textPath: function() {\r\n      if (this.node.firstChild && this.node.firstChild.nodeName == 'textPath')\r\n        return SVG.adopt(this.node.firstChild)\r\n    }\r\n  }\r\n})\nSVG.Nested = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('svg'))\r\n\r\n    this.style('overflow', 'visible')\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create nested svg document\r\n    nested: function() {\r\n      return this.put(new SVG.Nested)\r\n    }\r\n  }\r\n})\nSVG.A = SVG.invent({\r\n  // Initialize node\r\n  create: 'a'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Link url\r\n    to: function(url) {\r\n      return this.attr('href', url, SVG.xlink)\r\n    }\r\n    // Link show attribute\r\n  , show: function(target) {\r\n      return this.attr('show', target, SVG.xlink)\r\n    }\r\n    // Link target attribute\r\n  , target: function(target) {\r\n      return this.attr('target', target)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a hyperlink element\r\n    link: function(url) {\r\n      return this.put(new SVG.A).to(url)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Create a hyperlink element\r\n  linkTo: function(url) {\r\n    var link = new SVG.A\r\n\r\n    if (typeof url == 'function')\r\n      url.call(link, link)\r\n    else\r\n      link.to(url)\r\n\r\n    return this.parent().put(link).put(this)\r\n  }\r\n\r\n})\nSVG.Marker = SVG.invent({\r\n  // Initialize node\r\n  create: 'marker'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Set width of element\r\n    width: function(width) {\r\n      return this.attr('markerWidth', width)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return this.attr('markerHeight', height)\r\n    }\r\n    // Set marker refX and refY\r\n  , ref: function(x, y) {\r\n      return this.attr('refX', x).attr('refY', y)\r\n    }\r\n    // Update marker\r\n  , update: function(block) {\r\n      // remove all content\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Return the fill id\r\n  , toString: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    marker: function(width, height, block) {\r\n      // Create marker element in defs\r\n      return this.defs().marker(width, height, block)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Defs, {\r\n  // Create marker\r\n  marker: function(width, height, block) {\r\n    // Set default viewbox to match the width and height, set ref to cx and cy and set orient to auto\r\n    return this.put(new SVG.Marker)\r\n      .size(width, height)\r\n      .ref(width / 2, height / 2)\r\n      .viewbox(0, 0, width, height)\r\n      .attr('orient', 'auto')\r\n      .update(block)\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Line, SVG.Polyline, SVG.Polygon, SVG.Path, {\r\n  // Create and attach markers\r\n  marker: function(marker, width, height, block) {\r\n    var attr = ['marker']\r\n\r\n    // Build attribute name\r\n    if (marker != 'all') attr.push(marker)\r\n    attr = attr.join('-')\r\n\r\n    // Set marker attribute\r\n    marker = arguments[1] instanceof SVG.Marker ?\r\n      arguments[1] :\r\n      this.doc().marker(width, height, block)\r\n\r\n    return this.attr(attr, marker)\r\n  }\r\n\r\n})\n// Define list of available attributes for stroke and fill\r\nvar sugar = {\r\n  stroke: ['color', 'width', 'opacity', 'linecap', 'linejoin', 'miterlimit', 'dasharray', 'dashoffset']\r\n, fill:   ['color', 'opacity', 'rule']\r\n, prefix: function(t, a) {\r\n    return a == 'color' ? t : t + '-' + a\r\n  }\r\n}\r\n\r\n// Add sugar for fill and stroke\r\n;['fill', 'stroke'].forEach(function(m) {\r\n  var i, extension = {}\r\n\r\n  extension[m] = function(o) {\r\n    if (typeof o == 'undefined')\r\n      return this\r\n    if (typeof o == 'string' || SVG.Color.isRgb(o) || (o && typeof o.fill === 'function'))\r\n      this.attr(m, o)\r\n\r\n    else\r\n      // set all attributes from sugar.fill and sugar.stroke list\r\n      for (i = sugar[m].length - 1; i >= 0; i--)\r\n        if (o[sugar[m][i]] != null)\r\n          this.attr(sugar.prefix(m, sugar[m][i]), o[sugar[m][i]])\r\n\r\n    return this\r\n  }\r\n\r\n  SVG.extend(SVG.Element, SVG.FX, extension)\r\n\r\n})\r\n\r\nSVG.extend(SVG.Element, SVG.FX, {\r\n  // Map rotation to transform\r\n  rotate: function(d, cx, cy) {\r\n    return this.transform({ rotation: d, cx: cx, cy: cy })\r\n  }\r\n  // Map skew to transform\r\n, skew: function(x, y, cx, cy) {\r\n    return this.transform({ skewX: x, skewY: y, cx: cx, cy: cy })\r\n  }\r\n  // Map scale to transform\r\n, scale: function(x, y, cx, cy) {\r\n    return arguments.length == 1  || arguments.length == 3 ?\r\n      this.transform({ scale: x, cx: y, cy: cx }) :\r\n      this.transform({ scaleX: x, scaleY: y, cx: cx, cy: cy })\r\n  }\r\n  // Map translate to transform\r\n, translate: function(x, y) {\r\n    return this.transform({ x: x, y: y })\r\n  }\r\n  // Map flip to transform\r\n, flip: function(a, o) {\r\n    return this.transform({ flip: a, offset: o })\r\n  }\r\n  // Map matrix to transform\r\n, matrix: function(m) {\r\n    return this.attr('transform', new SVG.Matrix(m))\r\n  }\r\n  // Opacity\r\n, opacity: function(value) {\r\n    return this.attr('opacity', value)\r\n  }\r\n  // Relative move over x axis\r\n, dx: function(x) {\r\n    return this.x((this instanceof SVG.FX ? 0 : this.x()) + x, true)\r\n  }\r\n  // Relative move over y axis\r\n, dy: function(y) {\r\n    return this.y((this instanceof SVG.FX ? 0 : this.y()) + y, true)\r\n  }\r\n  // Relative move over x and y axes\r\n, dmove: function(x, y) {\r\n    return this.dx(x).dy(y)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Rect, SVG.Ellipse, SVG.Circle, SVG.Gradient, SVG.FX, {\r\n  // Add x and y radius\r\n  radius: function(x, y) {\r\n    var type = (this._target || this).type;\r\n    return type == 'radial' || type == 'circle' ?\r\n      this.attr('r', new SVG.Number(x)) :\r\n      this.rx(x).ry(y == null ? x : y)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Path, {\r\n  // Get path length\r\n  length: function() {\r\n    return this.node.getTotalLength()\r\n  }\r\n  // Get point at length\r\n, pointAt: function(length) {\r\n    return this.node.getPointAtLength(length)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Parent, SVG.Text, SVG.FX, {\r\n  // Set font\r\n  font: function(o) {\r\n    for (var k in o)\r\n      k == 'leading' ?\r\n        this.leading(o[k]) :\r\n      k == 'anchor' ?\r\n        this.attr('text-anchor', o[k]) :\r\n      k == 'size' || k == 'family' || k == 'weight' || k == 'stretch' || k == 'variant' || k == 'style' ?\r\n        this.attr('font-'+ k, o[k]) :\r\n        this.attr(k, o[k])\r\n\r\n    return this\r\n  }\r\n})\r\n\r\n\nSVG.Set = SVG.invent({\r\n  // Initialize\r\n  create: function(members) {\r\n    // Set initial state\r\n    Array.isArray(members) ? this.members = members : this.clear()\r\n  }\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add element to set\r\n    add: function() {\r\n      var i, il, elements = [].slice.call(arguments)\r\n\r\n      for (i = 0, il = elements.length; i < il; i++)\r\n        this.members.push(elements[i])\r\n\r\n      return this\r\n    }\r\n    // Remove element from set\r\n  , remove: function(element) {\r\n      var i = this.index(element)\r\n\r\n      // remove given child\r\n      if (i > -1)\r\n        this.members.splice(i, 1)\r\n\r\n      return this\r\n    }\r\n    // Iterate over all members\r\n  , each: function(block) {\r\n      for (var i = 0, il = this.members.length; i < il; i++)\r\n        block.apply(this.members[i], [i, this.members])\r\n\r\n      return this\r\n    }\r\n    // Restore to defaults\r\n  , clear: function() {\r\n      // initialize store\r\n      this.members = []\r\n\r\n      return this\r\n    }\r\n    // Get the length of a set\r\n  , length: function() {\r\n      return this.members.length\r\n    }\r\n    // Checks if a given element is present in set\r\n  , has: function(element) {\r\n      return this.index(element) >= 0\r\n    }\r\n    // retuns index of given element in set\r\n  , index: function(element) {\r\n      return this.members.indexOf(element)\r\n    }\r\n    // Get member at given index\r\n  , get: function(i) {\r\n      return this.members[i]\r\n    }\r\n    // Get first member\r\n  , first: function() {\r\n      return this.get(0)\r\n    }\r\n    // Get last member\r\n  , last: function() {\r\n      return this.get(this.members.length - 1)\r\n    }\r\n    // Default value\r\n  , valueOf: function() {\r\n      return this.members\r\n    }\r\n    // Get the bounding box of all members included or empty box if set has no items\r\n  , bbox: function(){\r\n      var box = new SVG.BBox()\r\n\r\n      // return an empty box of there are no members\r\n      if (this.members.length == 0)\r\n        return box\r\n\r\n      // get the first rbox and update the target bbox\r\n      var rbox = this.members[0].rbox()\r\n      box.x      = rbox.x\r\n      box.y      = rbox.y\r\n      box.width  = rbox.width\r\n      box.height = rbox.height\r\n\r\n      this.each(function() {\r\n        // user rbox for correct position and visual representation\r\n        box = box.merge(this.rbox())\r\n      })\r\n\r\n      return box\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a new set\r\n    set: function(members) {\r\n      return new SVG.Set(members)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.FX.Set = SVG.invent({\r\n  // Initialize node\r\n  create: function(set) {\r\n    // store reference to set\r\n    this.set = set\r\n  }\r\n\r\n})\r\n\r\n// Alias methods\r\nSVG.Set.inherit = function() {\r\n  var m\r\n    , methods = []\r\n\r\n  // gather shape methods\r\n  for(var m in SVG.Shape.prototype)\r\n    if (typeof SVG.Shape.prototype[m] == 'function' && typeof SVG.Set.prototype[m] != 'function')\r\n      methods.push(m)\r\n\r\n  // apply shape aliasses\r\n  methods.forEach(function(method) {\r\n    SVG.Set.prototype[method] = function() {\r\n      for (var i = 0, il = this.members.length; i < il; i++)\r\n        if (this.members[i] && typeof this.members[i][method] == 'function')\r\n          this.members[i][method].apply(this.members[i], arguments)\r\n\r\n      return method == 'animate' ? (this.fx || (this.fx = new SVG.FX.Set(this))) : this\r\n    }\r\n  })\r\n\r\n  // clear methods for the next round\r\n  methods = []\r\n\r\n  // gather fx methods\r\n  for(var m in SVG.FX.prototype)\r\n    if (typeof SVG.FX.prototype[m] == 'function' && typeof SVG.FX.Set.prototype[m] != 'function')\r\n      methods.push(m)\r\n\r\n  // apply fx aliasses\r\n  methods.forEach(function(method) {\r\n    SVG.FX.Set.prototype[method] = function() {\r\n      for (var i = 0, il = this.set.members.length; i < il; i++)\r\n        this.set.members[i].fx[method].apply(this.set.members[i].fx, arguments)\r\n\r\n      return this\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\n\r\nSVG.extend(SVG.Element, {\r\n  // Store data values on svg nodes\r\n  data: function(a, v, r) {\r\n    if (typeof a == 'object') {\r\n      for (v in a)\r\n        this.data(v, a[v])\r\n\r\n    } else if (arguments.length < 2) {\r\n      try {\r\n        return JSON.parse(this.attr('data-' + a))\r\n      } catch(e) {\r\n        return this.attr('data-' + a)\r\n      }\r\n\r\n    } else {\r\n      this.attr(\r\n        'data-' + a\r\n      , v === null ?\r\n          null :\r\n        r === true || typeof v === 'string' || typeof v === 'number' ?\r\n          v :\r\n          JSON.stringify(v)\r\n      )\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.extend(SVG.Element, {\r\n  // Remember arbitrary data\r\n  remember: function(k, v) {\r\n    // remember every item in an object individually\r\n    if (typeof arguments[0] == 'object')\r\n      for (var v in k)\r\n        this.remember(v, k[v])\r\n\r\n    // retrieve memory\r\n    else if (arguments.length == 1)\r\n      return this.memory()[k]\r\n\r\n    // store memory\r\n    else\r\n      this.memory()[k] = v\r\n\r\n    return this\r\n  }\r\n\r\n  // Erase a given memory\r\n, forget: function() {\r\n    if (arguments.length == 0)\r\n      this._memory = {}\r\n    else\r\n      for (var i = arguments.length - 1; i >= 0; i--)\r\n        delete this.memory()[arguments[i]]\r\n\r\n    return this\r\n  }\r\n\r\n  // Initialize or return local memory object\r\n, memory: function() {\r\n    return this._memory || (this._memory = {})\r\n  }\r\n\r\n})\n// Method for getting an element by id\r\nSVG.get = function(id) {\r\n  var node = document.getElementById(idFromReference(id) || id)\r\n  return SVG.adopt(node)\r\n}\r\n\r\n// Select elements by query string\r\nSVG.select = function(query, parent) {\r\n  return new SVG.Set(\r\n    SVG.utils.map((parent || document).querySelectorAll(query), function(node) {\r\n      return SVG.adopt(node)\r\n    })\r\n  )\r\n}\r\n\r\nSVG.extend(SVG.Parent, {\r\n  // Scoped select method\r\n  select: function(query) {\r\n    return SVG.select(query, this.node)\r\n  }\r\n\r\n})\nfunction is(el, obj){\r\n  return el instanceof obj\r\n}\r\n\r\n// tests if a given selector matches an element\r\nfunction matches(el, selector) {\r\n  return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);\r\n}\r\n\r\n// Convert dash-separated-string to camelCase\r\nfunction camelCase(s) {\r\n  return s.toLowerCase().replace(/-(.)/g, function(m, g) {\r\n    return g.toUpperCase()\r\n  })\r\n}\r\n\r\n// Capitalize first letter of a string\r\nfunction capitalize(s) {\r\n  return s.charAt(0).toUpperCase() + s.slice(1)\r\n}\r\n\r\n// Ensure to six-based hex\r\nfunction fullHex(hex) {\r\n  return hex.length == 4 ?\r\n    [ '#',\r\n      hex.substring(1, 2), hex.substring(1, 2)\r\n    , hex.substring(2, 3), hex.substring(2, 3)\r\n    , hex.substring(3, 4), hex.substring(3, 4)\r\n    ].join('') : hex\r\n}\r\n\r\n// Component to hex value\r\nfunction compToHex(comp) {\r\n  var hex = comp.toString(16)\r\n  return hex.length == 1 ? '0' + hex : hex\r\n}\r\n\r\n// Calculate proportional width and height values when necessary\r\nfunction proportionalSize(element, width, height) {\r\n  if (width == null || height == null) {\r\n    var box = element.bbox()\r\n\r\n    if (width == null)\r\n      width = box.width / box.height * height\r\n    else if (height == null)\r\n      height = box.height / box.width * width\r\n  }\r\n\r\n  return {\r\n    width:  width\r\n  , height: height\r\n  }\r\n}\r\n\r\n// Delta transform point\r\nfunction deltaTransformPoint(matrix, x, y) {\r\n  return {\r\n    x: x * matrix.a + y * matrix.c + 0\r\n  , y: x * matrix.b + y * matrix.d + 0\r\n  }\r\n}\r\n\r\n// Map matrix array to object\r\nfunction arrayToMatrix(a) {\r\n  return { a: a[0], b: a[1], c: a[2], d: a[3], e: a[4], f: a[5] }\r\n}\r\n\r\n// Parse matrix if required\r\nfunction parseMatrix(matrix) {\r\n  if (!(matrix instanceof SVG.Matrix))\r\n    matrix = new SVG.Matrix(matrix)\r\n\r\n  return matrix\r\n}\r\n\r\n// Add centre point to transform object\r\nfunction ensureCentre(o, target) {\r\n  o.cx = o.cx == null ? target.bbox().cx : o.cx\r\n  o.cy = o.cy == null ? target.bbox().cy : o.cy\r\n}\r\n\r\n// Convert string to matrix\r\nfunction stringToMatrix(source) {\r\n  // remove matrix wrapper and split to individual numbers\r\n  source = source\r\n    .replace(SVG.regex.whitespace, '')\r\n    .replace(SVG.regex.matrix, '')\r\n    .split(SVG.regex.matrixElements)\r\n\r\n  // convert string values to floats and convert to a matrix-formatted object\r\n  return arrayToMatrix(\r\n    SVG.utils.map(source, function(n) {\r\n      return parseFloat(n)\r\n    })\r\n  )\r\n}\r\n\r\n// Calculate position according to from and to\r\nfunction at(o, pos) {\r\n  // number recalculation (don't bother converting to SVG.Number for performance reasons)\r\n  return typeof o.from == 'number' ?\r\n    o.from + (o.to - o.from) * pos :\r\n\r\n  // instance recalculation\r\n  o instanceof SVG.Color || o instanceof SVG.Number || o instanceof SVG.Matrix ? o.at(pos) :\r\n\r\n  // for all other values wait until pos has reached 1 to return the final value\r\n  pos < 1 ? o.from : o.to\r\n}\r\n\r\n// PathArray Helpers\r\nfunction arrayToString(a) {\r\n  for (var i = 0, il = a.length, s = ''; i < il; i++) {\r\n    s += a[i][0]\r\n\r\n    if (a[i][1] != null) {\r\n      s += a[i][1]\r\n\r\n      if (a[i][2] != null) {\r\n        s += ' '\r\n        s += a[i][2]\r\n\r\n        if (a[i][3] != null) {\r\n          s += ' '\r\n          s += a[i][3]\r\n          s += ' '\r\n          s += a[i][4]\r\n\r\n          if (a[i][5] != null) {\r\n            s += ' '\r\n            s += a[i][5]\r\n            s += ' '\r\n            s += a[i][6]\r\n\r\n            if (a[i][7] != null) {\r\n              s += ' '\r\n              s += a[i][7]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return s + ' '\r\n}\r\n\r\n// Deep new id assignment\r\nfunction assignNewId(node) {\r\n  // do the same for SVG child nodes as well\r\n  for (var i = node.childNodes.length - 1; i >= 0; i--)\r\n    if (node.childNodes[i] instanceof SVGElement)\r\n      assignNewId(node.childNodes[i])\r\n\r\n  return SVG.adopt(node).id(SVG.eid(node.nodeName))\r\n}\r\n\r\n// Add more bounding box properties\r\nfunction fullBox(b) {\r\n  if (b.x == null) {\r\n    b.x      = 0\r\n    b.y      = 0\r\n    b.width  = 0\r\n    b.height = 0\r\n  }\r\n\r\n  b.w  = b.width\r\n  b.h  = b.height\r\n  b.x2 = b.x + b.width\r\n  b.y2 = b.y + b.height\r\n  b.cx = b.x + b.width / 2\r\n  b.cy = b.y + b.height / 2\r\n\r\n  return b\r\n}\r\n\r\n// Get id from reference string\r\nfunction idFromReference(url) {\r\n  var m = url.toString().match(SVG.regex.reference)\r\n\r\n  if (m) return m[1]\r\n}\r\n\r\n// Create matrix array for looping\r\nvar abcdef = 'abcdef'.split('')\n// Add CustomEvent to IE9 and IE10\r\nif (typeof CustomEvent !== 'function') {\r\n  // Code from: https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\r\n  var CustomEvent = function(event, options) {\r\n    options = options || { bubbles: false, cancelable: false, detail: undefined }\r\n    var e = document.createEvent('CustomEvent')\r\n    e.initCustomEvent(event, options.bubbles, options.cancelable, options.detail)\r\n    return e\r\n  }\r\n\r\n  CustomEvent.prototype = window.Event.prototype\r\n\r\n  window.CustomEvent = CustomEvent\r\n}\r\n\r\n// requestAnimationFrame / cancelAnimationFrame Polyfill with fallback based on Paul Irish\r\n(function(w) {\r\n  var lastTime = 0\r\n  var vendors = ['moz', 'webkit']\r\n\r\n  for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n    w.requestAnimationFrame = w[vendors[x] + 'RequestAnimationFrame']\r\n    w.cancelAnimationFrame  = w[vendors[x] + 'CancelAnimationFrame'] ||\r\n                              w[vendors[x] + 'CancelRequestAnimationFrame']\r\n  }\r\n\r\n  w.requestAnimationFrame = w.requestAnimationFrame ||\r\n    function(callback) {\r\n      var currTime = new Date().getTime()\r\n      var timeToCall = Math.max(0, 16 - (currTime - lastTime))\r\n\r\n      var id = w.setTimeout(function() {\r\n        callback(currTime + timeToCall)\r\n      }, timeToCall)\r\n\r\n      lastTime = currTime + timeToCall\r\n      return id\r\n    }\r\n\r\n  w.cancelAnimationFrame = w.cancelAnimationFrame || w.clearTimeout;\r\n\r\n}(window))\r\n\r\nreturn SVG\r\n\r\n}));\n},{}],2:[function(require,module,exports){\n'use strict';\n\nrequire('./polyfills');\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nvar _templates = require('./templates');\n\nvar _templates2 = _interopRequireDefault(_templates);\n\nvar _functions = require('./functions');\n\nvar _game = require('./game');\n\nvar _game2 = _interopRequireDefault(_game);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nwindow.onload = function (undefined) {\n    var container = document.getElementById('container'),\n        launch = document.getElementById('launch'),\n        stop = document.getElementById('stop'),\n        timeContainer = document.getElementById('time-container'),\n        time = document.getElementById('time'),\n        results = document.getElementById('results'),\n        winnerTemplate = _templates2.default.winner.replace('{{winner}}', _constants2.default.strings.WINNER).replace('{{moves_text}}', _constants2.default.strings.MOVES).replace('{{time_text}}', _constants2.default.strings.TIME),\n        game = new _game2.default(container);\n\n    launch.addEventListener('click', game.launch);\n    stop.addEventListener('click', game.stop);\n\n    game.onLaunch = function () {\n        launch.classList.add(_constants2.default.classes.HIDDEN);\n        timeContainer.classList.remove(_constants2.default.classes.HIDDEN);\n        stop.classList.remove(_constants2.default.classes.HIDDEN);\n    };\n\n    game.onEach = function (seconds) {\n        time.innerHTML = (0, _functions.formatTime)(seconds);\n    };\n\n    game.onStop = function (moves, seconds, won) {\n        launch.classList.remove(_constants2.default.classes.HIDDEN);\n        timeContainer.classList.add(_constants2.default.classes.HIDDEN);\n        time.innerHTML = '00:00:00';\n        stop.classList.add(_constants2.default.classes.HIDDEN);\n\n        if (won) {\n            results.innerHTML = winnerTemplate.replace('{{moves}}', moves).replace('{{time}}', (0, _functions.formatTime)(seconds));\n        }\n    };\n\n    // Draw empty squares to fill the scene\n    game.drawEmpty();\n};\n\n},{\"./constants\":3,\"./functions\":4,\"./game\":5,\"./polyfills\":7,\"./templates\":9}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = {\n    strings: {\n        WINNER: 'You won!',\n        MOVES: 'Moves',\n        TIME: 'Elapsed time'\n    },\n    classes: {\n        VISIBLE: 'is-visible',\n        HIDDEN: 'is-hidden',\n        SELECTED: 'is-selected'\n    },\n    dimensions: {\n        SQUARE_SIZE: 50,\n        SQUARE_MARGIN: 5\n    },\n    direction: {\n        UNDEF: -1,\n        LEFT: 0,\n        RIGHT: 1,\n        UP: 2,\n        DOWN: 3\n    },\n    animation: {\n        MOVE_DURATION: 50\n    }\n};\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.formatTime = exports.getDirectionFromKeyCode = exports.getRandomGameNumbers = exports.getRandomInt = exports.range = exports.inArray = undefined;\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Checks whether values array contains specific value\nfunction inArray(value, values) {\n    return values.indexOf(value) > -1;\n}\n\n// Creates an array of integers\nfunction range(start, count) {\n    return Array.apply(0, new Array(count)).map(function (element, index) {\n        return index + start;\n    });\n}\n\n// Returns a random integer within specified bounds\nfunction getRandomInt(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\n// Returns a complete set of randomly generated square indices for the game\nfunction getRandomGameNumbers() {\n    return range(1, 16).sort(function (_) {\n        return Math.floor(Math.random() * 16) - 1;\n    });\n}\n\n// Converts keyboard key codes to custom constants\nfunction getDirectionFromKeyCode(code) {\n    switch (code) {\n        case 38:\n            return _constants2.default.direction.UP;\n        case 40:\n            return _constants2.default.direction.DOWN;\n        case 37:\n            return _constants2.default.direction.LEFT;\n        case 39:\n            return _constants2.default.direction.RIGHT;\n        default:\n            return _constants2.default.direction.UNDEF;\n    }\n}\n\n// Formats given seconds into H:i:s format\nfunction formatTime(seconds) {\n    var hours = Math.floor(seconds / 3600),\n        minutes = Math.floor((seconds - hours * 3600) / 60);\n\n    seconds = seconds - hours * 3600 - minutes * 60;\n\n    if (hours < 10) {\n        hours = '0' + hours;\n    }\n\n    if (minutes < 10) {\n        minutes = '0' + minutes;\n    }\n\n    if (seconds < 10) {\n        seconds = '0' + seconds;\n    }\n\n    return hours + ':' + minutes + ':' + seconds;\n}\n\nexports.inArray = inArray;\nexports.range = range;\nexports.getRandomInt = getRandomInt;\nexports.getRandomGameNumbers = getRandomGameNumbers;\nexports.getDirectionFromKeyCode = getDirectionFromKeyCode;\nexports.formatTime = formatTime;\n\n},{\"./constants\":3}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (container) {\n    var _this = this;\n\n    var that = this,\n        game = (0, _svg2.default)(container),\n        combinationToWin = (0, _functions.range)(1, 16),\n        moves = 0,\n        started = false,\n        squares = new _squares2.default(game, _constants2.default.dimensions.SQUARE_SIZE + _constants2.default.dimensions.SQUARE_MARGIN),\n        timer = new _timer2.default();\n\n    // Add a reusable rectangle to the SVG's definitions\n    game.defs().svg(_images2.default.rectangle);\n\n    this.launch = function () {\n        moves = 0;\n        started = true;\n\n        squares.draw();\n\n        if (typeof _this.onLaunch === 'function') {\n            _this.onLaunch();\n        }\n\n        timer.start(_this.onEach);\n    };\n\n    this.draw = squares.draw;\n    this.drawEmpty = squares.drawEmpty;\n    this.start = function (each) {\n        return timer.start(each);\n    };\n    this.stop = function () {\n        started = false;\n\n        timer.stop(function (seconds) {\n            if (typeof _this.onStop === 'function') {\n                _this.onStop(moves, seconds, playerHasWon());\n            }\n        });\n\n        _this.drawEmpty();\n    };\n\n    // Handles mouse activities on the game surface.\n    // Once a square is clicked, it's checked upon movability or emptiness\n    // and then it's eigther selected or moved to a new position\n    container.addEventListener('mousedown', function (event) {\n        if (!started) {\n            return;\n        }\n\n        var square = squares.getSquareByNode(event.target);\n\n        if (!square) {\n            return;\n        }\n\n        if (squares.isMovable(square)) {\n            squares.select(square);\n        } else if (squares.isEmpty(square) && squares.move(squares.deselect())) {\n            countMove();\n        }\n    });\n\n    // Handles mouse activities outside the game surface\n    document.addEventListener('mousedown', function (event) {\n        if (!started || event.target.closest('#container')) {\n            return;\n        }\n\n        squares.deselect();\n    });\n\n    // Handles keyboard activities, allowing to play by using left-right-top-bottom keys\n    document.addEventListener('keydown', function (event) {\n        if (!started) {\n            return;\n        }\n\n        if (event.keyCode == 27) {\n            squares.deselect();\n\n            return;\n        }\n\n        if (!(0, _functions.inArray)(event.keyCode, (0, _functions.range)(37, 40))) {\n            return;\n        }\n\n        if (squares.moveByDirection((0, _functions.getDirectionFromKeyCode)(event.keyCode))) {\n            countMove();\n        }\n    });\n\n    function countMove() {\n        moves++;\n\n        if (playerHasWon()) {\n            that.stop();\n        }\n    }\n\n    // Checks current square positions with the winning combination\n    function playerHasWon() {\n        return squares.getPositions().every(function (position, index) {\n            return position == combinationToWin[index];\n        });\n    }\n};\n\nvar _svg = require('svg.js');\n\nvar _svg2 = _interopRequireDefault(_svg);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nvar _images = require('./images');\n\nvar _images2 = _interopRequireDefault(_images);\n\nvar _squares = require('./squares');\n\nvar _squares2 = _interopRequireDefault(_squares);\n\nvar _timer = require('./timer');\n\nvar _timer2 = _interopRequireDefault(_timer);\n\nvar _functions = require('./functions');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n;\n\n},{\"./constants\":3,\"./functions\":4,\"./images\":6,\"./squares\":8,\"./timer\":10,\"svg.js\":1}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = {\n    rectangle: '<rect id=\"square\" rx=\"4\" ry=\"4\" width=\"50\" height=\"50\"></rect>',\n    square: '<svg width=\"50\" height=\"50\"><use fill=\"#ffd121\" href=\"#square\"></use><text x=\"50%\" y=\"50%\" stroke=\"none\" alignment-baseline=\"middle\" text-anchor=\"middle\">{{idx}}</text></svg>',\n    empty: '<svg id=\"empty-square\" width=\"50\" height=\"50\"><use fill=\"#272727\" stroke=\"#ffd121\" stroke-width=\"2\" href=\"#square\"></use></svg>'\n};\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nif (!Array.prototype.find) {\n    Array.prototype.find = function (predicate) {\n        if (this == null) {\n            throw new TypeError('Array.prototype.find called on null or undefined');\n        }\n\n        if (typeof predicate !== 'function') {\n            throw new TypeError('predicate must be a function');\n        }\n\n        var list = Object(this),\n            length = list.length >>> 0,\n            thisArg = arguments[1],\n            value = void 0;\n\n        for (var i = 0; i < length; i++) {\n            value = list[i];\n\n            if (predicate.call(thisArg, value, i, list)) {\n                return value;\n            }\n        }\n\n        return undefined;\n    };\n}\n\n},{}],8:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (container, size) {\n    var _this = this;\n\n    var squares = [],\n        emptySquare = void 0,\n        squareClass = 'game__square';\n\n    // Draws random set of squares on the game scene\n    this.draw = function () {\n        var group = getSquaresGroup().clear();\n\n        var leftIndex = 0,\n            topIndex = 0,\n            numbers = (0, _functions.getRandomGameNumbers)();\n\n        for (var idx = 0; idx <= 15; idx++) {\n            if (idx % 4 == 0 && idx > 0) {\n                leftIndex = 0;\n                topIndex++;\n            }\n\n            var x = size * leftIndex,\n                y = size * topIndex,\n                number = numbers.shift(),\n                svg = number == 16 ? _images2.default.empty : _images2.default.square.replace('{{idx}}', number);\n\n            group.svg(svg);\n            squares[idx] = group.get(idx).addClass(squareClass + ' js-square').attr({ x: x, y: y }).data('index', number);\n\n            leftIndex++;\n        }\n    };\n\n    // Draws empty squares to initially fill the game scene\n    this.drawEmpty = function () {\n        var group = getSquaresGroup().clear();\n\n        var leftIndex = 0,\n            topIndex = 0;\n\n        for (var idx = 0; idx <= 15; idx++) {\n            if (idx % 4 == 0 && idx > 0) {\n                leftIndex = 0;\n                topIndex++;\n            }\n\n            var x = size * leftIndex,\n                y = size * topIndex;\n\n            group.svg(_images2.default.empty);\n            squares[idx] = group.get(idx).addClass(squareClass).attr({ x: x, y: y });\n\n            leftIndex++;\n        }\n    };\n\n    // Returns the SVG square by the given DOM node\n    this.getSquareByNode = function (node) {\n        var svg = node.closest('svg');\n\n        if (!svg || !svg.classList.contains('js-square')) {\n            return null;\n        }\n\n        return squares.find(function (square) {\n            return square.data('index') == svg.getAttribute('data-index');\n        });\n    };\n\n    this.isEmpty = function (square) {\n        return square.attr('id') === 'empty-square';\n    };\n\n    // Checks whether a square can be moved.\n    // Movable squares are those which stand one position\n    // to the LEFT, RIGHT, TOP or BOTTOM from the empty square\n    this.isMovable = function (square) {\n        var box = square.tbox(),\n            emptyBox = getEmptySvgSquare().tbox(),\n            leftRight = [emptyBox.x - size, emptyBox.x + size],\n            topBottom = [emptyBox.y - size, emptyBox.y + size];\n\n        return box.y == emptyBox.y && (0, _functions.inArray)(box.x, leftRight) || box.x == emptyBox.x && (0, _functions.inArray)(box.y, topBottom);\n    };\n\n    // Marks a square as selected\n    this.select = function (square) {\n        deselect();\n\n        square.addClass(_constants2.default.classes.SELECTED);\n    };\n\n    this.deselect = function () {\n        return deselect();\n    };\n\n    // Returns or creates wrapping group of the squares\n    function getSquaresGroup() {\n        var group = _svg2.default.get('#squares-group');\n\n        return group ? group : container.group().attr('id', 'squares-group');\n    }\n\n    // Finds currently selected square and removes selection from it, returning the square itself\n    function deselect() {\n        var selected = squares.find(function (square) {\n            return square.hasClass(_constants2.default.classes.SELECTED);\n        });\n\n        if (selected) {\n            selected.removeClass(_constants2.default.classes.SELECTED);\n        }\n\n        return selected;\n    }\n\n    // Moves a square by direction defined in constants\n    this.moveByDirection = function (direction) {\n        var empty = getEmptySvgSquare(),\n            target = getSquareByCoords(getMoveCoordsFromDirection(empty, direction));\n\n        return _this.move(target, empty);\n    };\n\n    // Move a square by exchanging its position with the empty square\n    this.move = function (square, empty) {\n        if (!square) {\n            return false;\n        }\n\n        empty = empty || getEmptySvgSquare();\n\n        var emptyBox = empty.tbox(),\n            squareBox = square.tbox();\n\n        empty.animate(_constants2.default.animation.MOVE_DURATION).attr({\n            x: squareBox.x,\n            y: squareBox.y\n        });\n\n        square.animate(_constants2.default.animation.MOVE_DURATION).attr({\n            x: emptyBox.x,\n            y: emptyBox.y\n        });\n\n        reindexSquares(square);\n\n        return true;\n    };\n\n    function getEmptySvgSquare() {\n        if (!emptySquare) {\n            emptySquare = (0, _svg2.default)('empty-square');\n        }\n\n        return emptySquare;\n    }\n\n    // Calculates new coordinates for the square from the given direction of movement\n    function getMoveCoordsFromDirection(empty, direction) {\n        var coords = empty.tbox();\n\n        switch (direction) {\n            case _constants2.default.direction.LEFT:\n                return {\n                    x: coords.x + size,\n                    y: coords.y\n                };\n\n            case _constants2.default.direction.RIGHT:\n                return {\n                    x: coords.x - size,\n                    y: coords.y\n                };\n\n            case _constants2.default.direction.UP:\n                return {\n                    x: coords.x,\n                    y: coords.y + size\n                };\n\n            case _constants2.default.direction.DOWN:\n                return {\n                    x: coords.x,\n                    y: coords.y - size\n                };\n        }\n    }\n\n    // Returns a square by the given coordinates\n    function getSquareByCoords(coords) {\n        return squares.find(function (square) {\n            var box = square.tbox();\n\n            return box.x == coords.x && box.y == coords.y;\n        });\n    }\n\n    // Exchange indices of the currently moving square (target) and the empty square\n    function reindexSquares(target) {\n        var targetIndex = squares.indexOf(target),\n            empty = squares.find(function (square) {\n            return square.data('index') == 16;\n        }),\n            emptyIndex = squares.indexOf(empty);\n\n        squares[targetIndex] = empty;\n        squares[emptyIndex] = target;\n    }\n\n    this.getPositions = function () {\n        return squares.map(function (square) {\n            return square.data('index');\n        });\n    };\n};\n\nvar _svg = require('svg.js');\n\nvar _svg2 = _interopRequireDefault(_svg);\n\nvar _constants = require('./constants');\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nvar _images = require('./images');\n\nvar _images2 = _interopRequireDefault(_images);\n\nvar _functions = require('./functions');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n;\n\n},{\"./constants\":3,\"./functions\":4,\"./images\":6,\"svg.js\":1}],9:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = {\n    winner: '<span class=\"results__winner\">{{winner}}</span><br>{{moves_text}}: {{moves}}<br>{{time_text}}: {{time}}'\n};\n\n},{}],10:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function () {\n    var timer = void 0,\n        seconds = 0;\n\n    this.start = function (each) {\n        seconds = 0;\n\n        count(each);\n    };\n\n    this.stop = function (after) {\n        clearTimeout(timer);\n\n        if (typeof after === 'function') {\n            after(seconds);\n        }\n    };\n\n    function count(each) {\n        timer = setTimeout(function () {\n            return count(each);\n        }, 1000);\n\n        seconds++;\n\n        if (typeof each === 'function') {\n            each(seconds);\n        }\n    }\n};\n\n;\n\n},{}]},{},[2]);\n"]}